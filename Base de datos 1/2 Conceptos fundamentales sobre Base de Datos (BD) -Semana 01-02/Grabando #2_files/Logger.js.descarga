'use strict';self.Logger=function(){function e(b){a.realConsole.error("Logger Error: "+b)}function l(){a.waitingForWriteEnd=!1;""!==a.cached&&g()}function g(){if(!a.waitingForWriteEnd&&!a.waitingForStart)if(a.notSupported&&!a.writeToConsole)a.cached="";else if(!a.fileWriter||a.writeToConsole){var b=a.cached.split("\n");for(let d of b)""!==d&&a.realConsole.log(d);a.cached=""}else""!==a.cached&&(b=new Blob([a.cached],{type:"text/plain"}),a.cached="",a.waitingForWriteEnd=!0,a.fileWriter.write(b))}const a=
{realConsole:console,waitingForStart:!0,waitingForWriteEnd:!1,writeToConsole:RuntimeParams.isDebug(),notSupported:!1,cached:""},h=OffscreenProxy.for("Logger").connect(a),k="undefined"!==typeof window&&(window.requestFileSystem||window.webkitRequestFileSystem);k&&!Utils.isEmbed()?k(window.TEMPORARY,5242880,function(b){b.root.getDirectory("ScreenPal",{create:!0},function(d){d.getFile("LogFile",{create:!0},function(c){c.createWriter(function(f){a.fileEntry=c;a.fileWriter=f;a.fileWriter.seek(a.fileWriter.length);
a.fileWriter.onerror=e;a.fileWriter.onwriteend=l;h.set("logURL",a.fileEntry.toURL())},e)},e)},e)},e):a.notSupported=!0;a.logToConsole=function(){a.writeToConsole=!0;return"Will log to console..."};a.truncate=function(){a.fileWriter?a.fileWriter.truncate(0):a.realConsole.log("No FileWriter for log so nothing to truncate.")};a.startLogging=function(){a.waitingForStart=!1};h.listen("writeToLog",b=>{var d=b.type;b=b.text;var c=new Date;let f=6E4*c.getTimezoneOffset();c=(new Date(c.getTime()-f)).toISOString().slice(0,
19).replace(/-/g,"/").replace("T"," ");a.cached+=c+" "+d.toUpperCase()+": "+b+"\n";g()});return a}();