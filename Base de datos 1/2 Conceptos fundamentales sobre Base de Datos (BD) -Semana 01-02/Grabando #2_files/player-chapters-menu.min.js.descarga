function changeTimeFormat(e){let t=Math.floor(e/3600),r=Math.floor(e%3600/60),a=Math.floor(e%60);return 0===t?`${r}:${a.toString().padStart(2,0)}`:`${t}:${r.toString().padStart(2,0)}:${a.toString().padStart(2,0)}`}function displayChaptersMenu(){if(!document.querySelector(".vjs-chapters-menu")){let e=document.querySelector(".vjs-duration");e&&insertChapterElementAfter(createChaptersButton(),e)}}function createChaptersSelectButton(){if(!document.querySelector(".chapters-selector")){let e=document.createElement("ul");e.classList.add("vjs-menu-content","chapters-selector"),document.querySelector(".chapters-list-wrapper").appendChild(e);let t=document.createElement("div");t.classList.add("vjs-chapter-menu-title"),document.querySelector(".chapters-selector").appendChild(t);let r=document.createElement("div");r.textContent="Chapters",document.querySelector(".chapters-selector .vjs-chapter-menu-title").appendChild(r)}}function createChaptersListWrapper(){let e=document.createElement("div");return e.classList.add("chapters-list-wrapper"),e}function createChaptersButton(){let e=document.createElement("div"),t=document.createElement("button"),r=document.createElement("span");r.classList.add("vjs-icon-placeholder"),t.classList.add("vjs-menu-button","vjs-menu-button-popup"),t.style.backgroundColor=document.querySelector(".vjs-duration").style.backgroundColor,t.style.width="100%",t.style.height="100%",t.appendChild(r);let a=document.createElement("div");return a.classList.add("vjs-menu"),a.appendChild(createChaptersListWrapper()),e.classList.add("vjs-control","vjs-button","vjs-menu-button-popup","vjs-chapters-menu"),e.appendChild(t),e.appendChild(a),e.addEventListener("mouseenter",function(){this.classList.toggle("vjs-hover")}),e.addEventListener("mouseleave",function(){this.classList.toggle("vjs-hover")}),e}function createChapterTimelineMarker(e){if(0===e||e==videoPlayer.duration())return;let t=document.createElement("span");return t.style.left=e/videoPlayer.duration()*100+"%",t.style.backgroundColor=getComputedStyle(document.querySelector(".vjs-duration")).getPropertyValue("background-color"),t.classList.add("chapter-timeline-marker"),document.querySelector(".vjs-chapters-timeline-markers").appendChild(t),t}function insertChapterElementAfter(e,t){t.parentNode.insertBefore(e,t.nextSibling)}function hideChaptersMenu(){console.log("Hiding chapters menu...");let e=document.querySelector(".vjs-chapters-menu");e&&e.remove();let t=document.querySelector(".chapters-selector");t&&t.remove();let r=document.querySelector(".vjs-chapters-timeline-markers");r&&r.remove()}function populateChaptersMenu(e){if(!e||0===e.length){hideChaptersMenu();return}displayChaptersMenu(),createChaptersSelectButton();let t=document.querySelector(".vjs-chapters-timeline-markers");if(!t){(t=document.createElement("div")).classList.add("vjs-chapters-timeline-markers");let r=document.querySelector(".vjs-load-progress");null!==r&&insertChapterElementAfter(t,r)}let a=document.querySelector(".chapters-selector"),s=a.getElementsByTagName("li");for(;s.length;)s[0].remove();e.forEach(function(e){if("chapter"===e.type){let t=document.createElement("li");t.classList.add("vjs-menu-item","chapter-list-item","chapter-time");let r=document.createElement("div");r.textContent=changeTimeFormat(e.timestampMs/1e3),r.classList.add("chapter-timestamp");let a=document.createElement("div");a.classList.add("chapter-title"),a.textContent=e.copy,t.appendChild(r),t.appendChild(a),t.addEventListener("click",function(){let e=this.querySelector(".chapter-timestamp").textContent,t=hmsToSeconds(e);videoPlayer.setCurrentTime(t)}),document.querySelector(".chapters-selector").appendChild(t),createChapterTimelineMarker(hmsToSeconds(e.timestampMs/1e3))}}),addChapterTooltips()}function addChapterTooltips(){let e=document.querySelector(".vjs-chapters-menu .vjs-menu");e.style.display="block",e.style.opacity="0";let t=document.querySelectorAll(".chapter-list-item"),r=document.createElement("div");r.classList.add("chapter-tooltip-items"),t.forEach(e=>{let t=e.querySelector(".chapter-title");if(t&&t.offsetHeight<t.scrollHeight){let a=document.createElement("div");a.classList.add("chapter-tooltip"),a.textContent=t.textContent,a.style.display="none",r.appendChild(a),e.addEventListener("mouseenter",()=>{a.style.display="block"}),e.addEventListener("mousemove",e=>{let t=-a.offsetWidth-5,r=-a.offsetHeight-5,s=e.pageX+t,l=e.pageY+r;a.style.left=`${s}px`,a.style.top=`${l}px`}),e.addEventListener("mouseleave",()=>{a.style.display="none"})}}),document.getElementById("mp4Player").appendChild(r),e.removeAttribute("style")}videojs.registerPlugin("populateChaptersMenu",populateChaptersMenu);