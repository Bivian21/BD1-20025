'use strict';"object"!==typeof window.SPMain&&(window.SPMain=function(t){function D(a,c){a=SPRuntime.getSettings()[a];return void 0!==a&&null!==a?a:c}function K(a){return a.replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;")}function y(a){return a&&"function"===typeof a.getAttribute&&("true"===a.getAttribute("contenteditable")||"plaintext-only"===a.getAttribute("contenteditable"))}function Ia(a){(new MutationObserver(function(){let c=a.contentDocument.getElementsByTagName("g-notifications");for(let d of c)console.log("Found bad node added so removing: "+
d),d.parentNode.removeChild(d)})).observe(a.contentDocument,{childList:!0,subtree:!0})}function Ja(){document.body.spLoadedInDocument=ma();b.config={};b.pipState={};SPRuntime.isEmbed()||Ka();b.somLink=yb();b.somLinkDotTimeout=void 0;C(document,"selectionchange",b.selectionChangeListener=function(){if(!na()&&null!==b.somLink.contentWindow){var a=document.activeElement;setTimeout(function(){X(a)},500)}});La();zb();Ma(function(){null===b.somLink.contentWindow?na()||(k.log("We are unloaded but receiving events, so removing listeners (runOnUload: "+
b.runOnUnload.length+")"),Na()):(b.checkElementsTimeout&&clearTimeout(b.checkElementsTimeout),b.checkElementsTimeout=setTimeout(function(){if(null!==b.somLink.contentWindow){var a=(new Date).getTime();k.debug("Checking for elements after DOM update START.");La();k.debug("Checking for elements after DOM update FINISH (took "+((new Date).getTime()-a)+"ms).")}},500),b.somPlayLink&&0>=b.somPlayLink.getBoundingClientRect().width&&!b.somPlayLink.classList.contains("sp-highlight")&&Y())}).observe(document.documentElement||
document.body,{childList:!0,subtree:!0})}function oa(){var a=b.config.templates;if(a)for(let c of a)if(a=c.matchLocation,(new RegExp(a)).test(document.location)){k.debug('Matched location for template: "'+a+'": '+JSON.stringify(c));let d=c.placeholder.text;if(a=document.querySelector(c.placeholder.selector))if(b.checkTemlatesOnElementChange=!1,a.spTemplateWatching||(a.spTemplateWatching=!0,(new MutationObserver(oa)).observe(a,{childList:!0,subtree:!0})),-1!==a.value.indexOf(d)){for(let e of Ab)if(-1!==
a.value.indexOf(d+"\n"+e+"\n")){d+="\n"+e+"\n";break}a.spTemplateFound!==c.placeholder.summaryType&&(a.spTemplateFound=c.placeholder.summaryType,b.templateRecording=c.placeholder.summaryType,b.templateFunc=e=>{let f=g=>{let h=c.elements[g];if(h){var l=document.querySelector(h.selector);if(l){let m=l.value;m=m.replace(d,"").trim();l.value=Oa(m,h.type,e);H(" ",function(){l.focus();l.ownerDocument.execCommand("paste");l.value=l.value.trim();f(g+1)})}}else Pa(c)};f(0)},I(c.placeholder.summaryType+"-template"),
setTimeout(()=>{E(b.templateRecording)},500))}else a.spTemplateFound===c.placeholder.summaryType&&(a.spTemplateFound=void 0);else b.checkTemlatesOnElementChange=!0}}function Bb(a){let c=a.summaryType,d=a.elements;b.templateRecording=c;b.templateFunc=e=>{let f=g=>{var h=d[g];if(h){var l=document.querySelector(h.selector);l&&(h=Oa(h.text?h.text:l.value,h.type,e),H(h,function(){l.focus();l.ownerDocument.execCommand("paste");f(g+1)}))}else H(" ",()=>{}),Pa(a)};f(0)};I(c+"-template");setTimeout(()=>{E(b.templateRecording)},
1E3)}function Pa(a){if(a.postClick&&"button-inner-text"===a.postClick.type)for(let c of document.getElementsByTagName("button"))if(c.innerText===a.postClick.text){setTimeout(()=>{c.click()},1E3);break}}function Qa(){var a=b.config.templateMenus;if(a)for(let c of a)if(a=c.matchLocation,(new RegExp(a)).test(document.location)&&b.somTextArea&&b.somTextArea.matches(c.selector))return k.debug('Matched location and selector template menu: "'+a+'": '+JSON.stringify(c)),c;return null}function Cb(a){var c=
document.getElementById("som-template-menu");c&&document.body.removeChild(c);c="";for(var d of a)""!==c&&(c+=","),c+=d.name;d=SPRuntime.getURL("templates_menu.html?"+(new URLSearchParams({options:c})).toString());c=document.createElement("iframe");c.id="som-template-menu";c.style.width="120px";c.style.height="70px";c.style.position="absolute";c.style.visibility="visible";c.style.display="none";c.frameBorder=0;c.src=d;document.body.appendChild(c);b.somTemplateMenuFrame=c;b.somTemplateMenu=a}function Ra(){if(b.somTemplateMenuFrame&&
Z(b.somTextArea)&&!Sa()){let a=parseInt(b.somLink.style.top)-70,c=parseInt(b.somLink.style.left)-120+28;b.somTemplateMenuFrame.style.top=a+"px";b.somTemplateMenuFrame.style.left=c+"px";b.somTemplateMenuFrame.style.display="inline"}}function pa(){b.somTemplateMenuFrame&&(b.somTemplateMenuFrame.style.display="none")}function Oa(a,c,d){var e=a.match(/\[ScreenPal:.*?]/g);if(!e)return a;c="markdown"===c;let f=b.templatePlayUrl,g=b.templateShareUrl?b.templateShareUrl:qa(d,c);for(let h of e){e=h.substring(11,
h.length-1).trim();let l="";if("ThumbnailLink"===e)c&&(l="[!["+d.title+"]("+g+")]("+f+")");else if("Summary"===e)l=d.summary;else if("Title"===e)l=d.title;else if("ChaptersList"===e)d.chapters&&0<d.chapters.length?c&&(l=Ta(f,d.chapters)):console.error("Template: No chapters found in info.");else if("ActualBehavior"===e)d.summary_extra&&d.summary_extra.actual_behavior?l=d.summary_extra.actual_behavior:console.error("Template: No summary_extra.actual_behavior found in info.");else if("ExpectedBehavior"===
e)d.summary_extra&&d.summary_extra.expected_behavior?l=d.summary_extra.expected_behavior:console.error("Template: No summary_extra.expected_behavior found in info.");else{console.error("Template: Unknown type: "+e+" from text: "+h);continue}a=a.replace(h,l)}return a}function zb(){if(RegExp("https://.*screenpal.com/slack-recorder").test(document.location)){var a=(new URL(document.location)).searchParams;let c=a.get("start");a=a.get("onCancelURL");"web"!==c&&"fullscreen"!==c&&"webcam"!==c&&Ua(document.location);
SPRuntime.sendMessageToBackground({openSlackRecorder:document.location.href,type:c,onCancelUrl:a},function(d){d&&d.url&&(document.location=d.url)})}}function Ua(a){let c=(new URL(a)).searchParams;c.get("title");let d=c.get("start"),e=c.get("folder"),f=c.get("onDoneURL"),g=c.get("onCancelURL");b.onCancelRecording=function(){fa();SPRuntime.sendMessageToBackground({cancelSlackRecorder:a,onCancelUrl:g})};b.onDoneRecording=h=>{let l=f.replace("RECORDING_URL",h.playUrl).replace("TITLE",encodeURIComponent(h.title)).replace("DURATION_MS",
h.duration).replace("GIF_URL",encodeURIComponent(h.gifUrl));h=f.replace("RECORDING_URL",h.playUrl).replace("TITLE",encodeURIComponent(h.title)).replace("DURATION_MS",h.duration).replace("GIF_URL","WAITING");SPRuntime.sendMessageToBackground({postSlackRecorder:a,onDoneUrl:l,onWaitingForGifUrl:h})};b.recordingInProgress?b.recordingStarted={}:I("slack-recorder","web"===d?"tab":"fullscreen"===d?"fullscreen":"screen"===d?"screen,!camera":"webcam"===d?"!screen,camera":"screen,camera",e,!0)}function ma(){return document.location.href.split("#")[0]}
function na(){return document.body.spLoadedInDocument&&document.body.spLoadedInDocument===ma()?!1:(k.log("DOCUMENT REPLACED so redoing setupDocument!"),document.body.spLoadedInDocument&&(k.log("DOCUMENT REPLACED old:"+document.body.spLoadedInDocument),k.log("DOCUMENT REPLACED new:"+ma())),Na(),Ja(),!0)}function Na(){b.somTextArea&&F(b.somTextArea);for(let a of b.runOnUnload)a();b.runOnUnload=[]}function Va(){"setup"===b.recordingInProgress&&(O(),k.log("Telling BACKGROUND TO REBOOT to kill any waiting recorder setup."),
b.recordingInProgress=!1,SPRuntime.sendMessageToBackground({killRecorderSetup:!0}))}function aa(){b.recordingStarted&&b.recordingStarted.textArea&&0<b.recordingStarted.textArea.getBoundingClientRect().width&&Wa(b.recordingStarted.textArea,"");Va();b.recordingStarted=void 0;b.recordingInProgress=!1;b.somTextAreaSelectionRange=void 0;b.lastTooltipRecInfo={recId:0};b.tabCaptureEnabled=!1;b.editingAbandonedRecording=!1;b.templateRecording=!1;O();Xa();ha();b.pageIconEnabled?B(!1):B(!0)}function X(a,c){if(b.recorderEnabled&&
"som-link"!==a.id&&"som-tooltip-frame"!==a.id&&"som-link-hide"!==a.id){var d=D("selectTextAreas");if(d){let e=!1;for(let f of document.querySelectorAll(d))if(a===f){e=!0;break}if(!e){k.log('Not showing icon since selectTextAreas is set to "'+d+"\" which doesn't match element: "+A(a));b.somTextArea&&F(b.somTextArea);return}}y(a)&&!b.recordingInProgress&&(d=c?c.contentWindow.getSelection():t.getSelection(),d.rangeCount&&(b.somTextAreaSelectionRange=d.getRangeAt(0),k.log("New selection range to replace: "+
JSON.stringify(b.somTextAreaSelectionRange))));"textarea"===a.tagName.toLowerCase()&&"1"!==a.getAttribute("rows")||y(a)?a!==b.somTextArea&&(Ya(a,c),C(a,"focus",()=>{a!==b.somTextArea&&Ya(a,c)})):b.somTextArea&&F(b.somTextArea)}}function H(a,c){if(SPRuntime.isEmbed()){var d=document.createElement("textarea");d.value=a;document.body.appendChild(d);d.select();document.execCommand("copy");document.body.removeChild(d);c&&c()}else SPRuntime.sendMessageToBackground({copyText:a},function(e){e||k.log("Failed to copy text: "+
a);c&&c()})}function Db(){let a=document.getElementById("som-whiteboard-div");if(!a){a=document.createElement("div");a.id="som-whiteboard-dim";a.className="som-pop-frame-toggle-dim";a.style.zIndex=2147483646;document.body.appendChild(a);a=document.createElement("div");a.id="som-whiteboard-div";a.className="som-whiteboard-div";a.style.position="fixed";a.style.visibility="visible";a.style.display="block";a.scrolling="no";a.style.border=0;a.style.zIndex=2147483646;document.body.appendChild(a);ra(a);
var c=document.createElement("div");c.innerText="Use this whiteboard to record a drawing!";c.className="som-whiteboard-msg";c.style.zIndex=2147483647;document.body.appendChild(c);setTimeout(function(){document.body.removeChild(c)},7E3)}}function ha(){let a=document.getElementById("som-whiteboard-div");a&&document.body.removeChild(a);(a=document.getElementById("som-whiteboard-dim"))&&document.body.removeChild(a)}function Eb(a,c,d){var e=document.getElementById("som-effects-frame");if(e&&(e=-1!==e.src.indexOf("num\x3d"+
a),d||="fade-out",sa(e?d:void 0),e))return;if(P()||document.getElementById("som-tooltip-frame")||void 0!==b.lightbox){d=0;"slide-in-down"===c?d="-1280px":"slide-in-up"===c&&(d="1280px");e=1;"fade-in"===c&&(e=0);var f=G();a=SPRuntime.getURL("effects.html?"+(new URLSearchParams({num:a,colorScheme:f,width:t.innerWidth,height:t.innerHeight})).toString());var g=document.createElement("iframe");g.id="som-effects-frame";g.className="som-effects-frame";g.style.position="fixed";g.style.opacity=e;g.style.top=
d;g.style.left=0;g.style.width=t.innerWidth+"px";g.style.height=t.innerHeight+"px";g.style.visibility="visible";g.style.display="block";g.scrolling="no";g.style.pointerEvents="none";g.style.border=0;g.src=a;g.style.zIndex=2147483646;document.body.appendChild(g);c&&setTimeout(function(){g.classList.add("toggling-"+c)},100)}else console.log("Not doing effects since tab doesn't have recorder controls showing.")}function sa(a){let c=document.getElementById("som-effects-frame");c&&(a?(c.classList.add("toggling-"+
a),setTimeout(function(){sa()},1E3)):document.body.removeChild(c))}function Fb(a){if(!document.getElementById("som-draw-frame")){a=SPRuntime.getURL("draw.html?color\x3d"+a.color+"\x26size\x3d"+a.size+"\x26eraserSize\x3d"+a.eraserSize);var c=document.createElement("iframe");c.id="som-draw-frame";c.style.position="absolute";c.style.top=0;c.style.left=0;c.style.width=document.documentElement.scrollWidth+"px";c.style.height=document.documentElement.scrollHeight+"px";c.style.visibility="visible";c.style.display=
"block";c.scrolling="no";c.style.border=0;c.src=a;c.style.zIndex=2147483646;document.body.appendChild(c);document.getElementById("som-whiteboard-div")&&ra(c)}}function Gb(a){let c=document.getElementById("som-draw-frame");c&&c.contentWindow.postMessage(a.update,"*")}function Xa(){let a=document.getElementById("som-draw-frame");a&&document.body.removeChild(a)}function ta(a){function c(g,h){let l=document.createElement("div");l.id="som-pip-frame-container-"+g;l.classList.add("som-pip-frame-container-"+
g);d.appendChild(l);Hb(d,g,h)}if(document.getElementById("som-pip-frame-container"))a&&Za();else{var d=document.createElement("div");d.id="som-pip-frame-container";d.className="som-pip-frame-container";d.style.position="fixed";d.style.width=b.pipState.width;d.style.height=b.pipState.height;d.style.bottom=b.pipState.fixedBottom;d.style.right=b.pipState.fixedRight;d.style.left=b.pipState.fixedLeft;d.style.top=b.pipState.fixedTop;d.style.opacity=a?1:0;d.style.zIndex=2147483647;(a=document.getElementById("som-rec-controls"))?
document.body.insertBefore(d,a):document.body.appendChild(d);a=SPRuntime.getURL("pip.html");var e=document.createElement("iframe");e.className="som-pip-frame";e.allow="camera;microphone";e.style.width="100%";e.style.height="100%";e.style.visibility="visible";e.style.display="block";e.scrolling="no";e.src=a;d.appendChild(e);b.updatePIP=g=>{e.src=SPRuntime.getURL("pip.html?webcamOnly\x3d"+g)};c("move",function(g,h){return{top:d.offsetTop-h,left:d.offsetLeft-g}});c("resize-nw",function(g,h){return{top:d.offsetTop-
h,left:d.offsetLeft-g,width:d.offsetWidth+g,height:d.offsetHeight+h}});c("resize-n",function(g,h){return{top:d.offsetTop-h,height:d.offsetHeight+h}});c("resize-ne",function(g,h){return{top:d.offsetTop-h,width:d.offsetWidth-g,height:d.offsetHeight+h}});c("resize-e",function(g){return{width:d.offsetWidth-g}});c("resize-se",function(g,h){return{width:d.offsetWidth-g,height:d.offsetHeight-h}});c("resize-s",function(g,h){return{height:d.offsetHeight-h}});c("resize-sw",function(g,h){return{left:d.offsetLeft-
g,width:d.offsetWidth+g,height:d.offsetHeight-h}});c("resize-w",function(g){return{left:d.offsetLeft-g,width:d.offsetWidth+g}});var f=document.createElement("button");f.id="som-pip-frame-toggle-button";f.classList.add("som-pip-frame-toggle-button");f.innerHTML=b.pipGoBigButtonIcon;f.onclick=$a;d.appendChild(f);a=document.createElement("div");a.id="som-pip-frame-only-camera-msg";a.classList.add("som-pip-frame-only-camera-msg");a.innerHTML="Only Camera Video Will Be Recorded";d.appendChild(a);b.pipHideToggleFunction=
function(){"0"!==f.style.opacity&&(f.style.opacity="0",clearTimeout(b.pipHideToggleTimeout),b.pipHideToggleTimeout=void 0)};d.addEventListener("mousemove",function(){b.pipHideToggleTimeout&&(clearTimeout(b.pipHideToggleTimeout),b.pipHideToggleTimeout=void 0);f.style.opacity="1";b.pipToggled||(b.pipHideToggleTimeout=setTimeout(b.pipHideToggleFunction,1E3))});k.log("Added pip frame")}}function $a(){let a=document.getElementById("som-pip-frame-container");if(a)if(b.pipToggled)ab(),document.body.removeChild(document.getElementById("som-pop-frame-toggle-dim")),
document.getElementById("som-pip-frame-toggle-button").innerHTML=b.pipGoBigButtonIcon,b.pipToggled=!1,b.pipHideToggleTimeout=setTimeout(b.pipHideToggleFunction,1E3),a.classList.remove("big");else{ra(document.getElementById("som-pip-frame-container"));let c=document.createElement("div");c.id="som-pop-frame-toggle-dim";c.className="som-pop-frame-toggle-dim";c.style.zIndex=2147483646;document.body.appendChild(c);document.getElementById("som-pip-frame-toggle-button").innerHTML=b.pipGoSmallButtonIcon;
b.pipToggled=!0;a.classList.add("big")}}function ra(a){if(a){var c=t.innerWidth-50,d=t.innerHeight-50,e=1280;c<e&&(e=c);c=720*e/1280;d<c&&(c=d,e=1280*c/720);a.style.width=e+"px";a.style.height=c+"px";a.style.bottom="auto";a.style.right="auto";a.style.left="calc(50% - "+e/2+"px)";a.style.top="calc(50% - "+c/2+"px)"}}function ab(){let a=document.getElementById("som-pip-frame-container");a&&(a.style.width=b.pipState.width,a.style.height=b.pipState.height,a.style.bottom=b.pipState.fixedBottom,a.style.right=
b.pipState.fixedRight,a.style.left=b.pipState.fixedLeft,a.style.top=b.pipState.fixedTop)}function Za(){let a=document.getElementById("som-pip-frame-container");a&&(a.style.opacity=1,b.pipHideToggleTimeout=setTimeout(b.pipHideToggleFunction,3E3))}function O(){var a=document.getElementById("som-pip-frame-container");a&&document.body.removeChild(a);(a=document.getElementById("som-pop-frame-toggle-dim"))&&document.body.removeChild(a);b.pipToggled=!1}function Ib(a){var c=encodeURIComponent(a.title),d=
encodeURIComponent(a.subtitle),e=encodeURIComponent(a.subtext);a=encodeURIComponent(a.url);c="flyout-advert.html?title\x3d"+c+"\x26subtitle\x3d"+d+"\x26subtext\x3d"+e+"\x26url\x3d"+a;ua();d=SPRuntime.getURL(c);e=document.createElement("iframe");e.id="som-flyout-banner";e.className="som-flyout-banner";e.style.zIndex=2147483647;e.style.visibility="visible";e.style.opacity="0";e.style.top="20px";e.style.right="-200px";e.scrolling="no";e.src=d;document.body.appendChild(e);k.log("Added flyout advert with url: "+
c);return e}function Jb(a){let c=document.getElementById("som-flyout-banner");c&&(c.style.width=a.width+"px",c.style.height=a.height+"px",c.style.opacity="1",c.style.right="20px")}function va(a,c,d){let e=G();a=SPRuntime.getURL("flyout3.html?"+(new URLSearchParams({videoLink:a,title:c,gifUrl:d,colorScheme:e})).toString());let f=document.createElement("iframe");f.id="som-flyout-banner";f.style.position="fixed";f.style.width="520px";f.style.height="200px";f.style.top="10px";f.style.right="-530px";f.style.transition=
"2000ms";f.style.border=0;f.style.zIndex=2147483647;f.style.visibility="visible";f.style.display="block";f.scrolling="no";f.src=a;document.body.appendChild(f);k.log("Added in page recorder flyout");setTimeout(function(){f.style.right="10px";f.style.transition="500ms"},100)}function ua(){let a=document.getElementById("som-flyout-banner");a&&(a.style.opacity="0",setTimeout(function(){document.body.removeChild(a);a.hasOwnProperty("spRemovedCallback")&&a.spRemovedCallback()},1E3))}function ia(a){var c=
document.getElementById("som-rec-controls");if(c)if(-1!==c.src.indexOf("setup_inpage"))Q(!0),-1!==c.src.indexOf("tooltip_choose_what_to_record")&&R("");else return;c=G();a=a+(-1!==a.indexOf("?")?"\x26":"?")+"colorScheme\x3d"+encodeURIComponent(c)+"\x26isDrawingActive\x3d";c=!!document.getElementById("som-draw-frame");a=SPRuntime.getURL(a+c+"\x26templateRecording\x3d"+(!1!==b.templateRecording));c=document.createElement("iframe");c.id="som-rec-controls";c.allow="camera;microphone";c.style.position=
"fixed";c.style.width=0;c.style.height=0;c.style.bottom="0px";c.style.left=0;c.style.border=0;c.style.zIndex=2147483647;c.style.visibility="visible";c.style.display="block";c.scrolling="no";c.src=a;a=document.body.appendChild(c);k.log("Added floating controls with result: "+JSON.stringify(a))}function P(a){let c=document.getElementById("som-rec-controls");return c?c&&!a?!0:1!==c.src.indexOf(a):!1}function Q(a){let c=document.getElementById("som-rec-controls");c&&document.body.removeChild(c);a||bb()}
function ja(a){let c=document.getElementById("som-rec-controls");c&&(c.style.display=a?"none":"block")}function Kb(){let a=document.getElementById("som-rec-controls");a&&(a.id="som-rec-controls-video-pop-out",a.style.display="none")}function bb(){let a=document.getElementById("som-rec-controls-video-pop-out");a&&document.body.removeChild(a)}function cb(){let a=document.getElementById("som-rec-controls");if(a&&"0px"===a.style.left){b.slideOutHidPageIcon=!1;Lb()&&(b.slideOutHidPageIcon=!0,B(!0));let c=
Math.min(300,a.getBoundingClientRect().width);a.style.transition="500ms";a.style.left="-"+(c-25)+"px";setTimeout(function(){a.style.transition="none"},1E3)}}function Mb(){let a=document.getElementById("som-rec-controls");a&&"0px"!==a.style.left&&(a.style.transition="500ms",a.style.left="0px",setTimeout(function(){b.slideOutHidPageIcon&&(b.slideOutHidPageIcon=!1,B(!1));a.style.transition="none"},1E3))}function Nb(a){let c=document.getElementById("som-rec-controls");c&&(c.style.width=a.floatResize.width+
"px",c.style.height=a.floatResize.height+"px","0px"!==c.style.left&&(c.style.transition="none",c.style.left="-"+(a.floatResize.width-25)+"px"))}function db(a){return y(a)?a.innerText:a.value}function Z(a){a=db(a);a=a.replace(/[^\x00-\x7F]/g,"");return 0===a.trim().length}function eb(a,c,d){if(!ba(a,d)){var e;if(e=!Z(a))e=b.somTextAreaSelectionRange?0===b.somTextAreaSelectionRange.startOffset:0===a.selectionStart,e=!e;e&&(d="\n"+d);fb(a,c,d)}}function gb(a,c,d,e,f){if(e){e+="?t\x3d"+(new Date).getTime();
d=hb(c,"video",f,e,d);V(a,c,d);var g=document.querySelector('img[src\x3d"'+e+'"]');!g&&b.somIframe&&(g=b.somIframe.contentWindow.document.querySelector('img[src\x3d"'+e+'"]'));if(g){k.log("Share preview GIF set src to check: "+g.src);let h=(new Date).getTime(),l=function(){g.removeEventListener("load",l);300>g.width?(k.log("Share preview GIF not ready yet so will check again in a sec."),setTimeout(function(){wa(e,e,b.somIframe,h)},1E3)):k.log("Share preview GIF has width\x3e\x3d300 so no need to recheck (width: "+
g.width+")")};C(g,"load",l)}}else V(a,c,'\x3ca class\x3d"screenpal-text-link" target\x3d"_blank" href\x3d"'+d+'"\x3e'+d+"\x3c/a\x3e")}function Ta(a,c){let d="",e=1;for(let f of c)c=f.start.split(".",2)[0],d+="\n"+e+". ["+c+"]("+a+"?time\x3d"+c+") "+f.title,e++;return d.trim()}function hb(a,c,d,e,f,g){var h="",l="",m="";a.imgTextLink&&(l=a.imgTextLink,m=c,"string"!==typeof l&&(m||="video",l=-1!==f.indexOf("screenpal.com")&&l[m+"_sp"]?l[m+"_sp"]:l[m]),l=l.replace("TITLE",K(d)),m='\x3ca target\x3d"_blank" href\x3d"'+
f+'" data-screenpal-ignore\x3d"true"\x3e'+l+"\x3c/a\x3e",l='\x3cdiv style\x3d"margin-top: 10px;"\x3e'+m+"\x3c/div\x3e");""===a.imgBottomHtml?l="":a.imgBottomHtml&&(l=a.imgBottomHtml,l=l.replace("TITLE",K(d)),l=l.replace("LINK",m),l='\x3cdiv style\x3d"margin-top: 10px;"\x3e'+l+"\x3c/div\x3e");a.imgTopHtml&&(h=a.imgTopHtml,h=h.replace("TITLE",K(d)),h=h.replace("LINK",m),h='\x3cdiv style\x3d"margin-bottom: 10px;"\x3e'+h+"\x3c/div\x3e");d="";if(g)for(let n of g)g=n.start.split(".",2)[0],d+='\x3cdiv\x3e\x3ca target\x3d"_blank" href\x3d"'+
(f+"?time\x3d"+g)+'"\x3e'+g+"\x3c/a\x3e\x26nbsp;"+n.title+"\x3c/div\x3e";return'\x3cdiv class\x3d"screenpal-thumbnail-link"\x3e'+h+'\x3ca target\x3d"_blank" href\x3d"'+f+'"\x3e\x3cimg src\x3d"'+e+'" style\x3d"border-radius: 10px; border:1px solid #0e1637;" alt\x3d"'+f+'"/\x3e\x3c/a\x3e'+l+d+"\x3c/div\x3e"}function qa(a,c){var d=a.imageUrl;if(d.endsWith("png")||d.endsWith("jpg")){d=(new URL(d)).pathname;let e=d.substring(d.lastIndexOf("/")+1);d="https://share-preview.screenpal.com"+d;d=d.replace(e,
"sharePreview?");let f={};a.durationMS&&(f.durationMS=a.durationMS);"image"===a.type&&(f.drawPlayIcon=!1);c||(f.drawBorder=!1);"preview.jpg"!==e&&(f.filename=e);d+=(new URLSearchParams(f)).toString()}return d}function wa(a,c,d,e){let f=document.querySelector('img[src\x3d"'+c+'"]');!f&&d&&(f=d.contentWindow.document.querySelector('img[src\x3d"'+c+'"]'));if(f){let g=a+"\x26r\x3d"+(new Date).getTime();f.src=g;k.log("Share preview GIF not ready yet so setting up src to recheck: "+g);let h=function(){f.removeEventListener("load",
h);let l=(new Date).getTime();300>f.width&&1E4>l-e?(k.log("Share preview GIF not ready after recheck so will check again in a sec"),setTimeout(function(){wa(a,g,d,e)},1E3)):300<=f.width?k.log("Share preview GIF has width\x3e\x3d300 so finished (width: "+f.width+")"):k.log("Share preview GIF doesn't have width\x3e\x3d300 but time is up so not checking again.")};f.addEventListener("load",h)}else 1E4>(new Date).getTime()-e?(k.log("Share preview GIF not found so checking again in a sec."),setTimeout(function(){wa(a,
c,d,e)},1E3)):k.log("Share preview GIF not found but time is up so not checking again.")}function V(a,c,d){Wa(a,d)||fb(a,c,d)}function ba(a,c){if(y(a)){if(-1!==a.innerHTML.indexOf(c)||-1!==a.innerText.indexOf(c))return!0}else if(-1!==a.value.indexOf(c))return!0;return!1}function Ob(a,c){if(b.placeHolderPasteInProgress)return!0;var d=b.recordingInProgressPlaceHolderText;if(ba(a,K(d)))for(var e=a.ownerDocument.createTreeWalker(a,NodeFilter.SHOW_TEXT);e.nextNode();){let f=e.currentNode,g=f.textContent.indexOf(d);
if(-1!==g)return c=""===c?" ":c,e=a.ownerDocument.createRange(),d=g+d.length,e.setStart(f,g),e.setEnd(f,d),b.placeHolderPasteInProgress=!0,ib(a,e,c,function(){b.placeHolderPasteInProgress=!1}),!0}return!1}function Wa(a,c){if(b.placeHolderPasteInProgress)return!0;if(y(a)){if(b.recordingStarted.injectInfo.forceTextOnly)return Ob(a,c);let d=b.recordingInProgressPlaceHolderHtmlWithThumbnail;if(!ba(a,d)&&(d=b.recordingInProgressPlaceHolderHtmlNoThumbnail,!ba(a,d)))return!1;a.innerHTML=a.innerHTML.replace(d,
c);return!0}if(!ba(a,b.recordingInProgressPlaceHolderText))return!1;if(SPRuntime.isEmbed())return a.value=a.value.replace(b.recordingInProgressPlaceHolderText,c),!0;b.placeHolderPasteInProgress=!0;""===c&&(c=" ");a.spOrigScrollTop=a.scrollTop;a.selectionStart=a.value.indexOf(b.recordingInProgressPlaceHolderText);a.selectionEnd=a.selectionStart+b.recordingInProgressPlaceHolderText.length;H(c,function(){a.focus();a.ownerDocument.execCommand("paste");a.scrollTop=a.spOrigScrollTop;b.placeHolderPasteInProgress=
!1});return!0}function Pb(a,c,d){a.spOrigScrollTop=a.scrollTop;let e=a.value.indexOf(c);a.value.lastIndexOf(c)!==e?k.log("Found multiple instances of text so not trying to replace: "+c):(a.selectionStart=e,a.selectionEnd=e+c.length,H(d,function(){a.focus();a.ownerDocument.execCommand("paste");a.scrollTop=a.spOrigScrollTop;b.placeHolderPasteInProgress=!1}))}function Qb(a,c,d,e){let f=c.textLinkTitle?c.textLinkTitle:"Watch ScreenPal Video";if(e)return d="[!["+f+"]("+e+")]("+d+")",V(a,c,d),d;d="["+f+
"]("+d+")";V(a,c,d);return d}function fb(a,c,d){if(y(a)&&!c.forceTextOnly)d=(new DOMParser).parseFromString(d,"text/html").body.firstChild,b.somTextAreaSelectionRange?(b.somTextAreaSelectionRange.deleteContents(),b.somTextAreaSelectionRange.insertNode(d),b.somTextAreaSelectionRange=null):a.appendChild(d);else if(SPRuntime.isEmbed())if(a.selectionStart||"0"===a.selectionStart){c=a.selectionStart;let e=a.selectionEnd;a.value=a.value.substring(0,c)+d+a.value.substring(e,a.value.length);a.selectionStart=
c+d.length;a.selectionEnd=c+d.length}else a.value+=d;else ib(a,b.somTextAreaSelectionRange,d)}function ib(a,c,d,e){a.focus();setTimeout(function(){if(c){let f=a.ownerDocument.defaultView.getSelection();f.removeAllRanges();f.addRange(c)}H(d,function(){a.ownerDocument.execCommand("paste");setTimeout(function(){y(a)&&-1===a.innerText.indexOf(d)&&a.ownerDocument.execCommand("insertText",!0,d);e&&e()},100)})},500)}function La(){var a=document.getElementsByTagName("a");for(let d of a)jb(d);a=document.getElementsByTagName("iframe");
for(var c of a)Rb(c);b.convertTextLinksConfig&&Sb();b.unfurlWatchElementsInTextArea&&kb();if(b.isFirefox){c=document.getElementsByTagName("textarea");for(let d of c)C(d,"focus",()=>{X(d)}),C(d,"blur",()=>{})}b.checkTemlatesOnElementChange&&oa()}function kb(){if(b.somTextArea&&b.linkExpandEnabled){var a=db(b.somTextArea);a=a.replace(/[^\x00-\x7F]/g,"");if(a=a.match(/(?:^|\n\s*)(https:\/\/.*?screencasthost.com\/watch\/\w+?|https:\/\/.*?screenpal.com\/watch\/\w+?|https:\/\/.*?screenpal.com\/v\/\w+?)(?:$|\s*\n)/)){a.shift();
k.debug("Unfurling found this many: "+a.length);for(let c of a)if(k.debug("Unfurling text link: "+c),a=S(c)){let d=a[1],e=a[2];b.waitingForCheckUnfurlById[e]=f=>{delete b.waitingForCheckUnfurlById[e];b.chuckUnfurlDataById[e]=void 0===f?"none":f;if(f&&"none"!==f)if(b.somTextArea)if(k.debug("Unfurling got data: "+JSON.stringify(f)),y(b.somTextArea)){var g=qa(f,b.injectInfo.isMarkdown);g=hb(b.injectInfo,f.type,f.title,g,c,f.chapters);for(var h=document.createTreeWalker(b.somTextArea,NodeFilter.SHOW_TEXT);h.nextNode();){var l=
h.currentNode;l.textContent.replace(/[^\x00-\x7F]/g,"")===c&&(f=document.createElement("div"),f.innerHTML=g,l.parentNode.replaceChild(f.firstChild,l))}}else l=b.injectInfo,g=c,h=l.textLinkTitle?l.textLinkTitle:"Watch ScreenPal Video",h=(l=qa(f,l.isMarkdown))?"[!["+h+"]("+l+")]("+g+")":"["+h+"]("+g+")",f.chapters&&0<f.chapters.length&&(h+="\n"+Ta(g,f.chapters)),Pb(b.somTextArea,c,h);else k.debug("Unfurling got data but text area is deselected now: "+c);else k.debug("Unfurling got NO data so ignoring: "+
c)};if(b.chuckUnfurlDataById[e]){b.waitingForCheckUnfurlById[e](b.chuckUnfurlDataById[e]);break}SPRuntime.sendMessageToBackground({checkUnfurlUrl:{host:d,id:e,domain:document.location.host}})}}}}function Sb(){let a=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT);for(;a.nextNode();){let h=a.currentNode;var c=h.textContent,d=c.match(/(https:\/\/.*?screencast-o-matic.com\/watch\/\w+?|https:\/\/.*?screenpal.com\/watch\/\w+?|https:\/\/.*?screenpal.com\/v\/\w+?)\s*$/);if(d&&2===d.length){for(var e=
h.parentNode,f=!1,g=!1;e&&!y(e)&&"textarea"!==e.nodeName.toLowerCase();)(e=e.parentNode)&&"a"===e.nodeName.toLowerCase()&&(f=!0),e&&"svg"===e.nodeName.toLowerCase()&&(g=!0);if(!g&&(!e||!y(e)&&"textarea"!==e.nodeName.toLowerCase())){d=d[1];k.debug("Converting text to link: "+d);if(b.convertTextLinksConfig.useImages){g=S(d);if(!g){k.debug("Failed to parseSOMWatchUrl from linkText: "+d);continue}e=g[1];let l=g[2];g=b.convertTextLinksConfig.useImages.split("x",2);let m=parseInt(g[0]),n=parseInt(g[1]);
g=document.createElement("iframe");g.classList.add("som-replace-thumbnail-frame");g.src=SPRuntime.getURL("preview-thumbnail.html?host\x3d"+encodeURIComponent(e)+"\x26id\x3d"+l);g.style.width=m+"px";g.style.height=n+"px";e=g;f||(f=document.createElement("a"),f.href=d,f.target="_blank",f.appendChild(g),e=f)}else if(f)continue;else f=document.createElement("a"),f.href=d,f.target="_blank",f.innerText=d,e=f;f=document.createRange();c=c.indexOf(d);d=c+d.length;f.setStart(h,c);f.setEnd(h,d);f.deleteContents();
f.insertNode(e)}}}}function Rb(a){if((!a.id||!a.id.startsWith("som-")&&!a.id.startsWith("sp-"))&&a.contentDocument&&a.contentDocument.body){let c=a.contentDocument.getElementsByTagName("a");for(let d of c)jb(d,a);a.contentDocument.body.hasAttribute("data-som-added")||(a.contentDocument.body.setAttribute("data-som-added","true"),k.log("Found iframe no src with document to watch: "+A(a)),y(a.contentDocument.body)&&(a.contentDocument.hasFocus()&&(k.log("Found iframe in focus right now!"),X(a.contentDocument.body,
a)),C(a.contentDocument.body,"focus",()=>{setTimeout(function(){X(a.contentDocument.body,a)},500)})),C(a.contentDocument,"selectionchange",()=>{X(a.contentDocument.activeElement,a)}))}}function lb(a){let c=S(a.href);c||=S(a.innerText);return c}function S(a){if(a&&""!==a&&a.startsWith("https")){var c=a.match(/^https:\/\/(screencast-o-matic\.com|[a-zA-Z0-9-_]+\.screencast-o-matic\.com)\/watch\/(\w+)\\??.*$/);if(c&&3===c.length||(c=a.match(/^https:\/\/(screenpal\.com|[a-zA-Z0-9-_]+\.screenpal\.com)\/watch\/(\w+)\\??.*$/))&&
3===c.length||(c=a.match(/^https:\/\/([a-zA-Z0-9]+\.screencasthost\.com)\/watch\/(\w+)\\??.*$/))&&3===c.length||(c=a.match(/^(?:https|http):\/\/(somup\.com)\/(\w+)\\??.*$/))&&3===c.length||(c=a.match(/^https:\/\/(screenpal\.com)\/v\/(\w+)\\??.*$/))&&3===c.length)return c;c=void 0;try{(new URL(a)).searchParams.forEach(function(d,e){c||d.startsWith("https://")&&(c=S(d))})}catch(d){k.log("Ignroing url that failed to parse: '"+a+"'")}return c}}function jb(a,c){if(!a.hasAttribute("data-screenpal-ignore")&&
!a.hasOwnProperty("somAddedOnHoverListener")){var d=lb(a);if(d){a.somAddedOnHoverListener=!0;let e=d[1],f=d[2];k.log("Found SP playlink: "+a.href+" (id: "+f+" host:"+e+")");Ma(function(g){for(let h of g)"attributes"===h.type&&"href"===h.attributeName&&((g=lb(a))?(e=g[1],f=g[2],k.log("Found SP playlink reset: "+a.href+" (id: "+f+" host:"+e+")")):(f=e=void 0,k.log("Found SP playlink removed: "+a.href)))}).observe(a,{attributes:!0});C(a,"mousemove",g=>{g.buttons||e&&f&&xa(g,a,c,e,f)});C(a,"mouseout",
()=>{e&&f&&ya(a,f)});C(a,"click",()=>{e&&f&&(k.log("User clicked to open page for video so making sure any on hover play tooltip is closed."),ka())})}}}function F(a){if(a===b.somTextArea){L();mb()?k.log("SOM tooltip hiding but icon going away so leaving it."):b.somTooltip&&(b.recordingStarted&&"webcam"===b.recordingStarted.type?k.log("Textarea told to deactivate but webcam only in progress so NOT removing SOM tooltip."):(k.log("SOM tooltip open but icon going away so hiding."),x()));if("none"!==b.somLink.style.display){k.log("Textarea told to deactivate so hiding from element: "+
A(a));b.somResizeObserver&&b.somResizeObserver.disconnect();b.somResizeObserver2&&b.somResizeObserver2.disconnect();b.somMutationObserver&&b.somMutationObserver.disconnect();if(b.somParentScrollListners)for(let c of b.somParentScrollListners)c();b.somTextArea=void 0;b.somIframe=void 0;b.injectInfo=void 0;b.somResizeObserver=void 0;b.somResizeObserver2=void 0;b.somMutationObserver=void 0;b.somParentScrollListners=void 0;b.unfurlWatchElementsInTextArea=void 0;b.unfurlChangeListener&&(a.removeEventListener("change",
b.unfurlChangeListener),b.unfurlChangeListener=void 0);T();nb(a);pa();b.somLink.style.display="none"}b.positionTimeout&&(clearTimeout(b.positionTimeout),b.positionTimeout=void 0);b.advertiseOptions&&(b.advertiseOptions.shownOnce=!1)}}function ob(){return{useThumbnail:!1,isMarkdown:!1,forceTextLink:!1,forceTextOnly:!1,uploadPreview:!1,imgTextLink:null,imgBottomHtml:null,imgTopHtml:null,textLinkTitle:null,forceIconWhenSmall:"",nudgeInBoxX:0,nudgeInBoxY:0,nudgeAlwaysX:0,nudgeAlwaysY:0}}function pb(a){let c=
ob();var d=b.config.injectTypes;if(d)for(let g of d)if((new RegExp(g.matchLocation)).test(document.location)){d=g.type;k.log("Found injectType for site: "+JSON.stringify(g)+' (location: "'+document.location+'")');if(g.hasOwnProperty("limitElements")){let h=!1;for(let l of g.limitElements){if(l.hasOwnProperty("matchTagName")){var e=l.matchTagName.toLowerCase(),f=a.tagName.toLowerCase();if(e!==f){k.debug("Found injectType with limitElements that doesn't match matchTagName\x3d"+e+" tagName\x3d"+f);continue}}if(l.hasOwnProperty("matchIsEmpty")&&
(e=l.matchIsEmpty,f=Z(a),e!==f)){k.debug("Found injectType with limitElements that doesn't match mustBeEmpty\x3d"+e+" isEmpty\x3d"+f);continue}if(l.hasOwnProperty("matchMinHeight")&&(e=l.matchMinHeight,f=a.getBoundingClientRect().height,f<e)){k.debug("Found injectType with limitElements that doesn't match matchMinHeight\x3d"+e+" height\x3d"+f);continue}if(l.hasOwnProperty("matchAttributes")){e=l.matchAttributes;for(let m in e){f=e[m];let n=a.getAttribute(m);if(null!==n&&(new RegExp(f)).test(n)){h=
!0;if(!l.enable){k.debug("Found injectType with limitElements that disables element and matches attr '"+m+"' with value '"+n+"' using pattern '"+f+"' so ignoring.");return}break}}}else if(h=!0,!l.enable){k.debug("Found injectType with limitElements that disables all elements so ignoring.");return}if(h){l.hasOwnProperty("forceIconWhenSmall")&&(c.forceIconWhenSmall=l.forceIconWhenSmall);l.hasOwnProperty("nudgeInBoxX")&&(c.nudgeInBoxX=l.nudgeInBoxX);l.hasOwnProperty("nudgeInBoxY")&&(c.nudgeInBoxY=l.nudgeInBoxY);
l.hasOwnProperty("nudgeAlwaysX")&&(c.nudgeAlwaysX=l.nudgeAlwaysX);l.hasOwnProperty("nudgeAlwaysY")&&(c.nudgeAlwaysY=l.nudgeAlwaysY);break}}if(!h){k.debug("Found injectType with limitElements that didn't match element so ignoring.");continue}}"markdown"===d?(c.isMarkdown=!0,c.useThumbnail=!0,c.textLinkTitle=g.textLinkTitle):"img-link"===d?(c.useThumbnail=y(a),c.imgTextLink=g.imgTextLink,c.imgBottomHtml=g.imgBottomHtml,c.imgTopHtml=g.imgTopHtml,c.useThumbnail||k.log("Ignoring type 'img-link' since element isn't contenteditable.")):
"text-link"===d?c.forceTextLink=!0:"text-only"===d?c.forceTextOnly=!0:k.error("We don't recognize inject type: "+d);g.hasOwnProperty("uploadPreview")&&(c.uploadPreview=g.uploadPreview);break}return c}function Ya(a,c){function d(p,q){p.addEventListener("scroll",q);b.somParentScrollListners.push(function(){p.removeEventListener("scroll",q)})}if(a!==b.somTextArea)if(b.somTextArea&&F(b.somTextArea),P())k.log("Not showing icon since floating controls are showing.");else if(a.hasAttribute("data-screenpal-ignore"))k.log("Not showing icon since text area has 'data-screenpal-ignore'");
else{var e=pb(a);if(e){k.log("Selection update in element that we don't have in focus so activating link in: "+A(a));var f=a.getBoundingClientRect().width;if(25>f){if(-1===e.forceIconWhenSmall.indexOf("width")){k.log("Textarea focus but too small so not showing for now since width \x3d "+f+" for: "+A(a));return}k.log("Textarea width is small but injectInfo says to force: "+A(a))}f=a.getBoundingClientRect().height;if(20>f){if(-1===e.forceIconWhenSmall.indexOf("height")){k.log("Textarea focus but too small so not showing for now since height \x3d "+
f+" for: "+A(a));return}k.log("Textarea height is small but injectInfo says to force: "+A(a))}k.debug("Reposition Triggered: textarea focus so showing from element: "+A(a));ca();M(a,c,!1,200);b.somResizeObserver=new ResizeObserver(function(){M(a,c);k.debug("Reposition Triggered: textarea. ["+b.somLink.style.top+","+b.somLink.style.left+"]")});b.somResizeObserver.observe(a);b.somResizeObserver2=new ResizeObserver(function(){k.debug("Reposition Triggered: document. ["+b.somLink.style.top+","+b.somLink.style.left+
"]");M(a,c)});b.somResizeObserver2.observe(document.documentElement||document.body);var g="none",h="none",l=!0;b.somMutationObserver=new MutationObserver(function(p){let q="",r="";0!==p.length&&"attributes"===p[0].type&&(q=p[0].attributeName,r=(c?c:a).getAttribute(q));if(!b.ignoreMutation&&"spellcheck"!==q){if(g===q&&h===r&&""!==q){p=Z(a);if(p===l){k.debug("Reposition Triggered Skipped: mutation textarea or parent. (type:"+q+" value:"+r+")");return}k.debug("Reposition Triggered: isEmpty changed on textarea. (type:"+
q+" value:"+r+")");l=p}k.debug("Reposition Triggered: mutation textarea or parent. (type:"+q+" value:"+r+")");M(a,c);g=q;h=r}});b.somMutationObserver.observe(c?c:a,{attributes:!0});b.somParentScrollListners=[];for(var m=c?c:a;null!=m.parentElement;)m=m.parentElement,f=m.scrollHeight>m.clientHeight,(m.scrollWidth>m.clientWidth||f)&&d(m,function(){M(a,c);k.debug("Reposition Triggered: parent scroll for element: "+A(m)+"["+b.somLink.style.top+","+b.somLink.style.left+"]")}),b.somMutationObserver.observe(m,
{attributes:!0});m=c?c:a;for(f=void 0;null!=m&&void 0===f;){var n=t.getComputedStyle(m).getPropertyValue("background-color");if(n.startsWith("rgb(")&&(k.log("Found first rgb from element: "+n),(n=n.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/))&&4===n.length)){f=parseInt(n[1]);let p=parseInt(n[2]);n=parseInt(n[3]);n=.2126*f+.7152*p+.0722*n;f=40>n;k.log("Background is: "+(f?"DARK":"LIGHT")+" (luma: "+n+")")}m=m.parentElement}b.somLink.contentWindow.document.getElementById("SPIcon").setAttribute("fill",f?
"#FFFFFF":"#45526B");b.bgIsDark=f;d(document,function(){M(a,c);k.debug("Reposition Triggered: document scroll.")});b.somLink.contentWindow&&(b.somLink.contentWindow.document.documentElement.style.colorScheme=G());b.somTextArea=a;b.somIframe=c;b.injectInfo=e;b.unfurlWatchElementsInTextArea=!1;b.unfurlChangeListener=void 0;b.unfurlTimeout=void 0;b.unfurlWatchUrlsConfig&&b.linkExpandEnabled&&b.unfurlWatchUrlsConfig.selector&&a.matches(b.unfurlWatchUrlsConfig.selector)&&(y(a)?b.unfurlWatchElementsInTextArea=
!0:a.addEventListener("input",b.unfurlChangeListener=()=>{b.unfurlTimeout&&clearTimeout(b.unfurlTimeout);b.unfurlTimeout=setTimeout(kb,1E3)}));(e=Qa())&&Cb(e.menu)}else k.log("Textarea focus but injectInfo says to not show so ignoring: "+A(a))}}function Sa(){return b.somLink&&b.somLink.contentWindow.document.getElementById("som-link-background").classList.contains("dot")}function ca(){Sa()||b.somTooltip||b.somAdvertisement||(L(),b.somLinkDotTimeout=setTimeout(function(){b.somLinkDotTimeout=void 0;
b.somLink.contentWindow.document.getElementById("som-link-background").classList.add("dot-transition");pa();setTimeout(function(){b.somLink.contentWindow.document.getElementById("som-link-background").classList.remove("dot-transition");b.somLink.contentWindow.document.getElementById("som-link-background").classList.add("dot");b.somLink.style.width="12px";b.somLink.style.height="12px";b.somLink.style.top=parseInt(b.somLink.style.top)+16+"px";b.somLink.style.left=parseInt(b.somLink.style.left)+16+"px"},
300)},3E3))}function L(){b.somLinkDotTimeout&&(clearTimeout(b.somLinkDotTimeout),b.somLinkDotTimeout=void 0)}function M(a,c,d,e=1E3){function f(v,J,z){let za=c?c:a;k.debug("Reposition: Checking type: "+v+" textarea: "+A(za));v=z;let W;for(;0<z&&(W=document.elementFromPoint(J,z+g.y))!==za&&!za.contains(W);)z-=5,k.debug("Reposition: Checking (current: "+v+" new: "+z+" elem: "+A(W)+")");if(null!==W&&0<z)return k.debug("Reposition: Checking Final (current: "+v+" new: "+z+" elem: "+A(W)+")"),w=!0,z;k.debug("Reposition: Checking Failed (current: "+
v+" new: "+z+" elem: "+A(W)+")");w|=0;return v}if(b.recorderEnabled)if(b.ignorePosition)k.debug("Reposition: Ignore.");else if(!d&&b.positionTimeout)e===b.positionTimeoutTime&&(clearTimeout(b.positionTimeout),b.positionTimeoutTime=e,b.positionTimeout=setTimeout(function(){k.debug("Reposition: Doing final check after: "+e+"ms");M(a,c,!0);b.positionTimeout=void 0},e));else{b.closeHideButton();T();pa();b.somLink.style.display="inline";b.somLink.style.opacity="0";var g=document.body.getBoundingClientRect(),
h=a.getBoundingClientRect(),l=b.somLink.getBoundingClientRect(),m=parseInt(t.getComputedStyle(document.body).marginLeft),n=parseInt(t.getComputedStyle(document.body).marginTop),p=h.top-g.top+n,q=h.left-g.left+m;m=p+h.height-l.height;n=q+h.width-l.width;k.debug("Reposition: Start (left: "+n+" top: "+m+" somLinkRect: "+JSON.stringify(l)+")");if(c){var r=c.getBoundingClientRect();m+=r.top;n+=r.left;m>r.bottom&&(m=r.bottom-g.top-l.height)}if(0!==p||0!==q||c){p=pb(a);m+=p.nudgeInBoxY;n+=p.nudgeInBoxX;
q=!1;h.height>l.height+14?(m-=7,n-=7):(m=h.height>l.height?m-(h.height-l.height)/2:m+(l.height-h.height)/2,n-=7,q=!0);!(0<=navigator.platform.toUpperCase().indexOf("MAC"))&&a.clientHeight<a.scrollHeight&&(k.log("SOM moving to left for scrollbar."),n-=15);h=t.getComputedStyle(c?c:a).getPropertyValue("z-index");r=c?c:a;for(var u=""!==h&&"auto"!==h?parseInt(h):0;null!=r.parentElement;)h=t.getComputedStyle(r).getPropertyValue("z-index"),""!==h&&"auto"!==h&&parseInt(h)>u&&(k.debug("Reposition: Found zIndex to base ours on: "+
h+" from: "+A(r)),u=h),r=r.parentElement;b.somLink.style.zIndex=0!==u?u+1:1;var w=!1;b.somLink.style.display="none";for(h=0;d&&!q&&h!==m;)h=m,m=f("TOP/LEFT",n,m),m=f("TOP/RIGHT",n+(l.width+1),m),m=f("BOTTOM/LEFT",n,m+(l.height+1))-(l.height+1),m=f("BOTTOM/RIGHT",n+(l.width+1),m+(l.height+1))-(l.height+1),m=f("BOTTOM",n+l.width/2,m+(l.height+1))-(l.height+1),m=f("LEFT",n,m+(l.height/2+1))-(l.height/2+1);if(w||!d||q||h!==m){b.somLink.style.display="inline";if(m+"px"!==b.somLink.style.top||n+"px"!==
b.somLink.style.left)m+=p.nudgeAlwaysY,n+=p.nudgeAlwaysX,b.somLink.style.top=m+"px",b.somLink.style.left=n+"px",T(),b.recordingStarted&&("webcam"===b.recordingStarted.type||b.recordingStarted.type.startsWith("both"))||x(),nb(a);d?(b.somLink.style.opacity="1.0",Ra(),b.advertiseOptions&&Tb(),Aa(a,c)):(b.positionTimeoutTime=e,b.positionTimeout=setTimeout(function(){k.debug("Reposition: Doing final check after: "+e+"ms");M(a,c,!0);b.positionTimeout=void 0},e))}else k.log("Active element is covered so hiding link."),
F(a)}else k.log("Active element has no position so hiding link."),F(a)}else k.debug("Reposition: Disabled.")}function yb(){var a=document.getElementById("som-link");a&&(k.log("Found old som-link to remove"),document.body.removeChild(a));let c=void 0,d=void 0,e=function(h){L();h.contentWindow.document.getElementById("som-link-background").classList.add("show-hover");d&&clearTimeout(d);b.closeHideButton=function(){c&&(h.contentWindow.document.getElementById("som-link-background").classList.remove("dual-hover"),
document.body.removeChild(c),c=void 0)}},f=function(h){h.contentWindow.document.getElementById("som-link-background").classList.remove("show-hover");d&&clearTimeout(d);d=setTimeout(function(){b.closeHideButton();ca()},10)};a='\x3chtml style\x3d"color-scheme: '+G()+';" lang\x3d"en"\x3e\x3cstyle\x3e    div { width: 24px; height: 24px; padding-top: 3px; padding-left: 4px; }    div.dot { padding: 0; width: 8px; height: 8px; background-color: #45526B; border-radius: 50%; }    div svg { border-radius: 50%; }    div.dot-transition svg { position:fixed; margin-top:13px; margin-left:12px; width: 8px; height:8px; transition: 300ms; background-color: #45526B;}    div.dot svg { width: 0; }    div:hover, .show-hover { background: rgb(211 211 211 / 50%); border-radius: 50%;}    div.dual-hover { border-radius: 0 50% 50% 0 !important; }    g-notifications { position: absolute; }\x3c/style\x3e\x3cbody style\x3d"padding:0; margin:0; cursor:pointer;"\x3e\x3cdiv id\x3d"som-link-background"\x3e\x3csvg width\x3d"20px" height\x3d"21px" viewBox\x3d"0 0 20 21" xmlns\x3d"http://www.w3.org/2000/svg" \x3e\n\x3ctitle\x3eCreate ScreenPal Video Message\x3c/title\x3e\n\x3cg id\x3d"Revised-SP" stroke\x3d"none" stroke-width\x3d"1" fill\x3d"none" fill-rule\x3d"evenodd"\x3e\n        \x3cg id\x3d"SPIcon" transform\x3d"translate(-705.000000, -586.000000)" fill\x3d"#45526B" fill-rule\x3d"nonzero"\x3e\n            \x3cg transform\x3d"translate(705.000000, 586.000000)"\x3e\n                \x3cg transform\x3d"translate(0.000000, 8.469716)"\x3e\n                    \x3cpath d\x3d"M15.0311927,2.99629172 C14.7412844,5.54388133 12.5981651,7.52781211 10,7.52781211 C7.40550459,7.52781211 5.26238532,5.54388133 4.96880734,2.99629172 L0,2.99629172 C0.300917431,8.31396786 4.66055046,12.5302843 10,12.5302843 C15.3394495,12.5302843 19.6954128,8.31396786 20,2.99629172 L15.0311927,2.99629172 Z"\x3e\x3c/path\x3e\n                    \x3cellipse cx\x3d"10" cy\x3d"2.41038319" rx\x3d"2.3853211" ry\x3d"2.41038319"\x3e\x3c/ellipse\x3e\n                \x3c/g\x3e\n                \x3cg opacity\x3d"0.8" transform\x3d"translate(0.066055, 0.000000)"\x3e\n                    \x3cg\x3e\n                        \x3cg transform\x3d"translate(0.466055, 0.000000)"\x3e\n                            \x3cellipse cx\x3d"9.46788991" cy\x3d"0.945611867" rx\x3d"1" ry\x3d"1"\x3e\x3c/ellipse\x3e\n                            \x3cellipse cx\x3d"0.935779817" cy\x3d"5.92583436" rx\x3d"1" ry\x3d"1"\x3e\x3c/ellipse\x3e\n                            \x3cellipse cx\x3d"18" cy\x3d"5.92583436" rx\x3d"1" ry\x3d"1"\x3e\x3c/ellipse\x3e\n                        \x3c/g\x3e\n                        \x3cg transform\x3d"translate(0.000000, 0.978986)"\x3e\n                            \x3cpath d\x3d"M9.93394495,3.98269468 C11.9082569,3.98269468 13.5449541,2.51792336 13.853211,0.60815822 C13.2330275,0.341161928 12.5798165,0.137206428 11.9045872,0 C11.8862385,1.08281829 11.012844,1.95797281 9.93394495,1.95797281 C8.8587156,1.95797281 7.9853211,1.08281829 7.96330275,0 C7.28807339,0.137206428 6.63486239,0.341161928 6.0146789,0.60815822 C6.32293578,2.52163164 7.95963303,3.98269468 9.93394495,3.98269468 Z"\x3e\x3c/path\x3e\n                            \x3cpath d\x3d"M4.8440367,6.95302843 C5.83119266,5.2249691 5.39449541,3.06304079 3.91559633,1.83930779 C3.37247706,2.25463535 2.86972477,2.72558714 2.42201835,3.24103832 C3.33944954,3.80098888 3.65137615,5.00247219 3.11192661,5.94066749 C2.57247706,6.88257108 1.38715596,7.20889988 0.451376147,6.68603214 C0.234862385,7.33127318 0.0844036697,8.00247219 0,8.69592089 C1.78348624,9.38195303 3.85688073,8.68108776 4.8440367,6.95302843 Z"\x3e\x3c/path\x3e\n                            \x3cpath d\x3d"M15.0238532,6.95302843 C16.0110092,8.68108776 18.0807339,9.38195303 19.8715596,8.69592089 C19.787156,8.00247219 19.6366972,7.32756489 19.4201835,6.68603214 C18.4844037,7.20889988 17.2954128,6.88257108 16.759633,5.94066749 C16.2238532,4.99876391 16.5357798,3.79728059 17.4495413,3.24103832 C16.9981651,2.72558714 16.4990826,2.25463535 15.9559633,1.83930779 C14.4733945,3.06304079 14.040367,5.22867738 15.0238532,6.95302843 Z"\x3e\x3c/path\x3e\n                        \x3c/g\x3e\n                    \x3c/g\x3e\n                \x3c/g\x3e\n            \x3c/g\x3e\n        \x3c/g\x3e\n    \x3c/g\x3e\n\x3c/svg\x3e\x3c/div\x3e\x3c/body\x3e\x3c/html\x3e';
let g=document.createElement("iframe");g.id="som-link";g.style.width="28px";g.style.height="28px";g.style.position="absolute";g.style.visibility="visible";g.style.display="none";g.frameBorder=0;document.body.appendChild(g);g.contentWindow.document.open();g.contentWindow.document.write(a);g.contentWindow.document.close();g.contentWindow.document.body.addEventListener("mousedown",function(){k.log("SOM icon mouse down.");b.ignorePosition=!0;setTimeout(function(){b.ignorePosition=!1},1E3)});g.contentWindow.document.body.addEventListener("click",
function(h){h.preventDefault();k.log("SOM icon clicked.");if(mb())k.log("SOM tooltip hiding while recording so ignoring click.");else{if(b.somTooltip){if(b.recordingStarted&&"webcam"===b.recordingStarted.type){k.log("SOM tooltip NOT closing since webcam only capture in progress.");return}if(Ba())k.log("SOM hide tooltip already showing so closing that and showing recorder tooltip."),x();else{k.log("SOM tooltip already showing so hiding.");x();return}}f(g);if(!1===navigator.onLine)k.log("SOM offline tooltip going to show."),
h=SPRuntime.getURL("tooltip_offline.html"),U(h,345,292);else if(b.recordingInProgress)qb();else{h=(new Date).getTime();b.lastTooltipRecInfo={recId:h,somTextArea:b.somTextArea,somIframe:b.somIframe,injectInfo:b.injectInfo};b.recordingStarted={textArea:b.lastTooltipRecInfo.somTextArea,iframe:b.lastTooltipRecInfo.somIframe,injectInfo:b.lastTooltipRecInfo.injectInfo,type:""};h=b.lastTooltipRecInfo.injectInfo.useThumbnail;b.recordingInProgressPlaceHolderText=h?"\x3c\x3c\x3c ScreenPal - Video link and thumbnail will go here \x3e\x3e\x3e":
"\x3c\x3c\x3c ScreenPal - Video link will go here \x3e\x3e\x3e";b.recordingInProgressPlaceHolderHtmlNoThumbnail=K(b.recordingInProgressPlaceHolderText);b.recordingInProgressPlaceHolderHtmlWithThumbnail="\x3cdiv\x3e"+K(b.recordingInProgressPlaceHolderText)+"\x3c/div\x3e";let l=b.recordingInProgressPlaceHolderText;y(b.lastTooltipRecInfo.somTextArea)&&!b.lastTooltipRecInfo.injectInfo.forceTextOnly&&(l=h?b.recordingInProgressPlaceHolderHtmlWithThumbnail:b.recordingInProgressPlaceHolderHtmlNoThumbnail);
eb(b.lastTooltipRecInfo.somTextArea,b.lastTooltipRecInfo.injectInfo,l);T("opened");I("text-box");F(b.somTextArea)}}});g.contentWindow.document.body.addEventListener("mouseenter",function(h){k.log("SOM icon mouse over.");L();g.contentWindow.document.getElementById("som-link-background").classList.contains("dot")&&(g.contentWindow.document.getElementById("som-link-background").classList.remove("dot"),g.style.width="28px",g.style.height="28px",g.style.top=parseInt(g.style.top)-16+"px",g.style.left=parseInt(g.style.left)-
16+"px",Ra());SPRuntime.isEmbed()||(e(g),c||(b.somTooltip?b.recordingStarted&&"webcam"===b.recordingStarted.type?k.log("SOM hide icon not showing since webcam only capture in progress."):k.log("SOM hide icon not showing since tooltip is open."):"0"!==g.style.opacity&&b.showHideButton&&(c=Ub(g),g.contentWindow.document.getElementById("som-link-background").classList.add("dual-hover"),c.contentWindow.document.body.addEventListener("mouseenter",function(l){k.log("SOM icon-hide mouse over.");e(g)}),c.contentWindow.document.body.addEventListener("mouseleave",
function(l){k.log("SOM icon-hide mouse leave.");f(g)}))))});g.contentWindow.document.body.addEventListener("mouseleave",function(h){k.log("SOM icon mouse leave.");SPRuntime.isEmbed()||f(g);ca()});Ia(g);return g}function Ub(a){var c=document.getElementById("som-link-hide");c&&(k.log("Found old som-link-hide to remove"),document.body.removeChild(c));c='\x3chtml style\x3d"color-scheme: '+G()+';" lang\x3d"en"\x3e\x3cstyle\x3e    div.background { background: rgb(211 211 211 / 50%); }    g-notifications { position: absolute; }\x3c/style\x3e\x3cbody style\x3d"padding:0; margin:0; cursor:pointer;"\x3e\x3cdiv class\x3d"background" style\x3d"width: 24px; height: 24px; border-radius: 50% 0 0 50%; padding-top: 3px; padding-left: 4px;"\x3e\x3cdiv style\x3d"padding-top: 5px; padding-left: 7px;"\x3e\x3csvg width\x3d"11px" height\x3d"11px" viewBox\x3d"0 0 11 11" version\x3d"1.1" xmlns\x3d"http://www.w3.org/2000/svg" xmlns:xlink\x3d"http://www.w3.org/1999/xlink"\x3e\n\x3ctitle\x3eHide ScreenPal on this site.\x3c/title\x3e\n    \x3cg id\x3d"Marketing" stroke\x3d"none" stroke-width\x3d"1" fill\x3d"none" fill-rule\x3d"evenodd" stroke-linecap\x3d"square"\x3e\n        \x3cg id\x3d"x-button" transform\x3d"translate(-1011.000000, -433.000000)" stroke\x3d"#979797" stroke-width\x3d"0.58016"\x3e\n            \x3cg id\x3d"Group" transform\x3d"translate(447.000000, 283.000000)"\x3e\n                \x3cg id\x3d"x" transform\x3d"translate(559.000000, 145.000000)"\x3e\n                    \x3cg id\x3d"x-without-circle" transform\x3d"translate(5.500000, 5.500000)"\x3e\n                        \x3cline x1\x3d"9.72222222" y1\x3d"0.277777778" x2\x3d"0.277777778" y2\x3d"9.72222222" id\x3d"Line"\x3e\x3c/line\x3e\n                        \x3cline x1\x3d"9.72222222" y1\x3d"0.277777778" x2\x3d"0.277777778" y2\x3d"9.72222222" id\x3d"Line-Copy" transform\x3d"translate(5.000000, 5.000000) scale(-1, 1) translate(-5.000000, -5.000000) "\x3e\x3c/line\x3e\n                    \x3c/g\x3e\n                \x3c/g\x3e\n            \x3c/g\x3e\n        \x3c/g\x3e\n    \x3c/g\x3e\n\x3c/svg\x3e\x3c/div\x3e\x3c/div\x3e\x3c/body\x3e\x3c/html\x3e';
let d=document.createElement("iframe");d.id="som-link-hide";d.style.width="28px";d.style.height="28px";d.style.position="absolute";d.style.visibility="visible";d.style.display="inline";d.frameBorder=0;d.style.top=a.style.top;d.style.left=parseFloat(a.style.left)-28+"px";d.style.zIndex=a.style.zIndex;document.body.appendChild(d);d.contentWindow.document.open();d.contentWindow.document.write(c);d.contentWindow.document.close();d.contentWindow.document.body.addEventListener("mousedown",function(){b.ignorePosition=
!0;setTimeout(function(){b.ignorePosition=!1},1E3)});d.contentWindow.document.body.addEventListener("click",function(e){k.log("SOM icon-hide clicked.");e.preventDefault();rb("recorder-enabled")});d.contentWindow.document.getElementById("x-button").setAttribute("stroke",b.bgIsDark?"#E0E0E0":"#979797");d.contentWindow.document.body.addEventListener("mouseenter",function(e){d.contentWindow.document.getElementById("x-button").setAttribute("stroke",b.bgIsDark?"#FFFFFF":"#344057")});d.contentWindow.document.body.addEventListener("mouseleave",
function(e){d.contentWindow.document.getElementById("x-button").setAttribute("stroke",b.bgIsDark?"#E0E0E0":"#979797")});Ia(d);return d}function Ca(a){var c=document.getElementById("sp-page-icon");c&&(k.log("Found old sp-page-icon to remove"),document.body.removeChild(c));c='\x3chtml style\x3d"color-scheme: '+G()+';" lang\x3d"en"\x3e\x3cstyle\x3e    div.round-right { position: fixed; top:0; right:0; background: #101429; border-radius: 0 50% 50% 0; width: 28px; height: 28px; padding-top: 6px; padding-left: 6px; }    div.left { position: fixed; top:0; left:0; background: #101429; width: calc(100% - 16px); height: 100%; }    .sp-icon { position: absolute; top: 5px; left: 5px; width: 25px; height: 22px; object-fit: none; object-position: 0; }    .sp-close-icon { position: fixed; top: 4px; right: 4px; padding:7px; border-left: 1px solid rgb(255 255 255 / 10%);  display: none; width: 11px; height: 11px;}    .show-hover .sp-close-icon { display: block; }     g-notifications { position: absolute; }@keyframes pulse {\n    0% { transform: scale(1); opacity: 1; }\n    50% { transform: scale(1.3); opacity: 1; }\n    100% { transform: scale(1); opacity: 1; }\n}\n\x3c/style\x3e\x3cbody style\x3d"padding:0; margin:0; cursor:pointer;"\x3e\x3cdiv class\x3d"round-right"\x3e\x3c/div\x3e\x3cdiv class\x3d"left"\x3e\x3csvg id\x3d"sp-icon" class\x3d"sp-icon" viewBox\x3d"0 0 20 21" xmlns\x3d"http://www.w3.org/2000/svg" \x3e\n\x3ctitle\x3eCreate ScreenPal Video\x3c/title\x3e\n\x3cg stroke\x3d"none" stroke-width\x3d"1" fill\x3d"none" fill-rule\x3d"evenodd"\x3e\n        \x3cg id\x3d"SPIcon" transform\x3d"translate(-705.000000, -586.000000)" fill\x3d"#FFFFFF" fill-rule\x3d"nonzero"\x3e\n            \x3cg transform\x3d"translate(705.000000, 586.000000)"\x3e\n                \x3cg transform\x3d"translate(0.000000, 8.469716)"\x3e\n                    \x3cpath d\x3d"M15.0311927,2.99629172 C14.7412844,5.54388133 12.5981651,7.52781211 10,7.52781211 C7.40550459,7.52781211 5.26238532,5.54388133 4.96880734,2.99629172 L0,2.99629172 C0.300917431,8.31396786 4.66055046,12.5302843 10,12.5302843 C15.3394495,12.5302843 19.6954128,8.31396786 20,2.99629172 L15.0311927,2.99629172 Z"\x3e\x3c/path\x3e\n                    \x3cellipse cx\x3d"10" cy\x3d"2.41038319" rx\x3d"2.3853211" ry\x3d"2.41038319"\x3e\x3c/ellipse\x3e\n                \x3c/g\x3e\n                \x3cg opacity\x3d"0.8" transform\x3d"translate(0.066055, 0.000000)"\x3e\n                    \x3cg\x3e\n                        \x3cg transform\x3d"translate(0.466055, 0.000000)"\x3e\n                            \x3cellipse cx\x3d"9.46788991" cy\x3d"0.945611867" rx\x3d"1" ry\x3d"1"\x3e\x3c/ellipse\x3e\n                            \x3cellipse cx\x3d"0.935779817" cy\x3d"5.92583436" rx\x3d"1" ry\x3d"1"\x3e\x3c/ellipse\x3e\n                            \x3cellipse cx\x3d"18" cy\x3d"5.92583436" rx\x3d"1" ry\x3d"1"\x3e\x3c/ellipse\x3e\n                        \x3c/g\x3e\n                        \x3cg transform\x3d"translate(0.000000, 0.978986)"\x3e\n                            \x3cpath d\x3d"M9.93394495,3.98269468 C11.9082569,3.98269468 13.5449541,2.51792336 13.853211,0.60815822 C13.2330275,0.341161928 12.5798165,0.137206428 11.9045872,0 C11.8862385,1.08281829 11.012844,1.95797281 9.93394495,1.95797281 C8.8587156,1.95797281 7.9853211,1.08281829 7.96330275,0 C7.28807339,0.137206428 6.63486239,0.341161928 6.0146789,0.60815822 C6.32293578,2.52163164 7.95963303,3.98269468 9.93394495,3.98269468 Z"\x3e\x3c/path\x3e\n                            \x3cpath d\x3d"M4.8440367,6.95302843 C5.83119266,5.2249691 5.39449541,3.06304079 3.91559633,1.83930779 C3.37247706,2.25463535 2.86972477,2.72558714 2.42201835,3.24103832 C3.33944954,3.80098888 3.65137615,5.00247219 3.11192661,5.94066749 C2.57247706,6.88257108 1.38715596,7.20889988 0.451376147,6.68603214 C0.234862385,7.33127318 0.0844036697,8.00247219 0,8.69592089 C1.78348624,9.38195303 3.85688073,8.68108776 4.8440367,6.95302843 Z"\x3e\x3c/path\x3e\n                            \x3cpath d\x3d"M15.0238532,6.95302843 C16.0110092,8.68108776 18.0807339,9.38195303 19.8715596,8.69592089 C19.787156,8.00247219 19.6366972,7.32756489 19.4201835,6.68603214 C18.4844037,7.20889988 17.2954128,6.88257108 16.759633,5.94066749 C16.2238532,4.99876391 16.5357798,3.79728059 17.4495413,3.24103832 C16.9981651,2.72558714 16.4990826,2.25463535 15.9559633,1.83930779 C14.4733945,3.06304079 14.040367,5.22867738 15.0238532,6.95302843 Z"\x3e\x3c/path\x3e\n                        \x3c/g\x3e\n                    \x3c/g\x3e\n                \x3c/g\x3e\n            \x3c/g\x3e\n        \x3c/g\x3e\n    \x3c/g\x3e\n\x3c/svg\x3e\x3csvg class\x3d"sp-close-icon" viewBox\x3d"0 0 11 11" version\x3d"1.1" xmlns\x3d"http://www.w3.org/2000/svg" xmlns:xlink\x3d"http://www.w3.org/1999/xlink"\x3e\n\x3ctitle\x3eHide icon on this site\x3c/title\x3e\n    \x3cg id\x3d"Marketing" stroke\x3d"none" stroke-width\x3d"1" fill\x3d"none" fill-rule\x3d"evenodd" stroke-linecap\x3d"square"\x3e\n        \x3cg id\x3d"x-button" transform\x3d"translate(-1011.000000, -433.000000)" stroke\x3d"#B8B8B8" stroke-width\x3d"0.58016"\x3e\n            \x3cg id\x3d"Group" transform\x3d"translate(447.000000, 283.000000)"\x3e\n                \x3cg id\x3d"x" transform\x3d"translate(559.000000, 145.000000)"\x3e\n                    \x3cg id\x3d"x-without-circle" transform\x3d"translate(5.500000, 5.500000)"\x3e\n                        \x3cline x1\x3d"9.72222222" y1\x3d"0.277777778" x2\x3d"0.277777778" y2\x3d"9.72222222" id\x3d"Line"\x3e\x3c/line\x3e\n                        \x3cline x1\x3d"9.72222222" y1\x3d"0.277777778" x2\x3d"0.277777778" y2\x3d"9.72222222" id\x3d"Line-Copy" transform\x3d"translate(5.000000, 5.000000) scale(-1, 1) translate(-5.000000, -5.000000) "\x3e\x3c/line\x3e\n                    \x3c/g\x3e\n                \x3c/g\x3e\n            \x3c/g\x3e\n        \x3c/g\x3e\n    \x3c/g\x3e\n\x3c/svg\x3e\x3c/div\x3e\x3c/body\x3e\x3c/html\x3e';
let d=document.createElement("iframe");d.id="sp-page-icon";d.style.width="34px";d.style.height="34px";d.style.position="fixed";d.style.visibility="visible";d.style.display=b.recorderEnabled?"block":"none";d.style.border="none";d.style.transitionDuration="500ms";d.frameBorder=0;d.style.bottom="20px";d.style.left=0;d.style.zIndex=2147483647;document.body.appendChild(d);d.contentWindow.document.open();d.contentWindow.document.write(c);d.contentWindow.document.close();d.contentWindow.document.body.addEventListener("mouseover",
function(e){e.preventDefault();!document.getElementById("som-tooltip-frame")&&(e=document.getElementById("sp-page-icon"))&&(e.style.width="65px",e.contentWindow.document.body.classList.add("show-hover"))});d.contentWindow.document.body.addEventListener("mouseout",function(e){e.preventDefault();document.getElementById("som-tooltip-frame")||da()});d.contentWindow.document.body.addEventListener("click",function(e){k.log("SOM sp-page-icon clicked.");e.preventDefault();e=30<=e.clientX;if(b.somTooltip){var f=
Ba();b.spPageIconTarget&&(document.body.removeChild(b.spPageIconTarget),b.spPageIconTarget=void 0);x();if(e===f)return}f=0;var g=e?38:16,h=document.getElementById("sp-page-icon-target");h&&document.body.removeChild(h);d&&(h=d.getBoundingClientRect(),f+=h.top,g+=h.left);f+=t.scrollY;h=document.createElement("div");h.id="sp-page-icon-target";h.style.opacity=0;h.style.pointerEvents="none";h.style.position="absolute";h.style.width="10px";h.style.height="1px";h.style.left=g+"px";h.style.top=f+"px";h.style.zIndex=
2147483647;document.body.appendChild(h);b.spPageIconTarget=h;e?a?B(!0):rb("page-icon-enabled",h):(a&&SPRuntime.sendMessageToBackground({tabCapture:!0}),b.recordingInProgress?qb(h):(da(),F(b.somTextArea),I("tab-icon")))});a&&setTimeout(()=>{d.contentWindow.document.body.dispatchEvent(new MouseEvent("click",{view:t,bubbles:!0,cancelable:!0,clientX:0,clientY:0,button:0}))},100);return d}function I(a,c,d,e){0===b.lastTooltipRecInfo.recId&&(b.lastTooltipRecInfo={recId:(new Date).getTime()});a={from:a,
type:"setup_inpage",recId:b.lastTooltipRecInfo.recId,tabCaptureEnabled:b.tabCaptureEnabled,templateRecording:!1!==b.templateRecording,host:document.location.host,defaultTitle:Da(),folder:d?d:"",drawBorderOnGIF:b.lastTooltipRecInfo.injectInfo&&b.lastTooltipRecInfo.injectInfo.isMarkdown,drawNoOverlaysOnGIF:e};c&&(a.forceToggles=c);ia("som_rec_controls.html?"+(new URLSearchParams(a)).toString())}function da(){let a=document.getElementById("sp-page-icon");a&&(a.style.width="34px",a.contentWindow.document.body.classList.remove("show-hover"))}
function B(a){let c=document.getElementById("sp-page-icon");c&&(c.style.display=a?"none":"block",a&&da())}function Lb(){let a=document.getElementById("sp-page-icon");return a?"block"===a.style.display:!1}function sb(a,c,d,e){k.log("SOM editor going to show.");let f=()=>{var m=t.innerWidth-40;let n=t.innerHeight-40,p=c.width;m<p+167&&(p=m-167);m=c.height*p/c.width;n<m+300&&(m=n-300,p=c.width*m/c.height);return{frameWidth:p+167,frameHeight:m+300}},g=f(),h=G();a=SPRuntime.getURL("editor.html?src\x3d"+
encodeURIComponent(a)+"\x26videoWidth\x3d"+c.width+"\x26videoHeight\x3d"+c.height+"\x26durationMS\x3d"+d+"\x26hasAudio\x3d"+e+"\x26colorScheme\x3d"+encodeURIComponent(h));Ea('\x3ciframe id\x3d"som-editor-frame" scrolling\x3d"no" allowfullscreen\x3d"true" style\x3d"border:0; overflow:hidden; width:'+g.frameWidth+"px; height:"+g.frameHeight+'px; border-radius: 5px;" src\x3d"'+a+'"\x3e\x3c/iframe\x3e');let l=document.getElementsByClassName("som-basicLightbox__placeholder")[0];b.somMutationObserverLightbox=
new MutationObserver(function(){1<l.childNodes.length&&l.removeChild(l.childNodes[1])});b.somMutationObserverLightbox.observe(l,{childList:!0,subtree:!0});SPRuntime.isEmbed()||SPRuntime.sendMessageToBackground({editorOpen:!0});B(!0);ha();b.editorResizeListener||t.addEventListener("resize",b.editorResizeListener=()=>{let m=document.getElementById("som-editor-frame");if(m){var n=f();m.style.width=n.frameWidth+"px";m.style.height=n.frameHeight+"px";m.contentWindow.postMessage(n,"*")}else t.removeEventListener("resize",
b.editorResizeListener),b.editorResizeListener=void 0})}function Fa(){R();b.editorResizeListener&&(t.removeEventListener("resize",b.editorResizeListener),b.editorResizeListener=void 0)}function ea(a,c){if(!document.getElementById("som-popup-menu")){a||(a="popup_menu.html?host\x3d"+encodeURIComponent(document.location.host),b.unfurlWatchUrlsConfig&&(a+="\x26unfurlAvailable\x3dtrue"));c||={width:345,height:393};k.log("Show the popup menu. (url: "+a+")");a=SPRuntime.getURL(a);var d=document.createElement("iframe");
d.id="som-popup-menu";d.style.position="fixed";d.style.width=c.width+"px";d.style.height=c.height+"px";d.style.borderRadius="10px";d.style.top="10px";d.style.right="10px";d.style.border=0;d.style.zIndex=2147483647;d.style.visibility="visible";d.scrolling="no";d.src=a;document.body.appendChild(d)}}function N(){let a=document.getElementById("som-popup-menu");if(!a)return!1;document.body.removeChild(a);return!0}function Vb(a){let c=document.getElementById("som-popup-menu");if(!c)return!1;c.style.transition=
"500ms";a.width&&(c.style.width=a.width+"px");a.height&&(c.style.height=a.height+"px");return!0}function tb(a){void 0===b.injectInfo&&(b.injectInfo=ob());var c=void 0!==a,d=(new Date).getTime(),e=D("useEffects",!SPRuntime.isEmbed());let f=D("animatedGif",a?"never":void 0),g=b.injectInfo.useThumbnail||c||void 0!==f&&"never"!==f&&"disabled"!==f,h=null!==b.showOnElementId||void 0!==a,l=b.injectInfo.uploadPreview||c;d={recId:d,title:Da(),uploadPreview:l,useGIF:g,drawBorderOnGIF:b.injectInfo.isMarkdown,
textOnly:h||b.injectInfo.forceTextLink||b.injectInfo.forceTextOnly||!g&&"textarea"===b.somTextArea.tagName.toLowerCase(),host:document.location.host,titleLabel:D("titleLabel",""),showTitle:D("showTitle","true"),showEffectsOption:e,showGifToggle:"never"!==f&&"always"!==f,isElementClick:h,isInPageRecorder:c,defaultCaptureType:D("defaultCaptureType","screen")};k.logToBackground("\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d User clicked icon to show ScreenPal (isInPageRecorder: "+c+")");c=SPRuntime.getURL("tooltip.html?"+
(new URLSearchParams(d)).toString());e=d.showGifToggle?323:290;d.showEffectsOption&&(e+=45);U(c,345,e,a)}function Wb(){k.log("SOM tooltip effect setup going to show.");let a=SPRuntime.getURL("tooltip_effects.html");U(a,289,287)}function Xb(){k.log("SOM tooltip settings going to show.");let a=SPRuntime.getURL("tooltip_settings.html");U(a,345,393)}function qb(a){k.log("SOM tooltip going to show for recording in progress.");let c=SPRuntime.getURL("tooltip_rec_in_progress.html");U(c,285,215,a)}function ub(a,
c){"Failed to fetch"===a&&(a="Looks like you're not connected to the internet");let d=SPRuntime.getURL("tooltip_rec_failed.html?error\x3d"+encodeURIComponent(a)),e=285,f=225;0<=navigator.platform.toUpperCase().indexOf("MAC")&&("Permission denied by system"===a||"Could not start video source"===a)?(k.log("SOM tooltip going to show message MACOS is blocking us."),d=SPRuntime.getURL("tooltip_rec_failed_macos.html"),e=305,f=330):k.log("SOM tooltip going to show message that recording failed with error: "+
a);U(d,e,f,c)}function Ba(){let a=document.getElementById("som-tooltip-frame");return a&&-1!==a.src.indexOf("tooltip_hide.html")}function rb(a,c){Ba()?x():(x(),k.log("SOM hide icon tooltip going to show."),a=SPRuntime.getURL("tooltip_hide.html?url\x3d"+encodeURIComponent(document.location)+"\x26type\x3d"+a),U(a,345,292,c))}function Tb(){if(!b.somAdvertisement&&!b.advertiseOptions.shownOnce){b.advertiseOptions.shownOnce=!0;L();var a=b.advertiseOptions.html;a&&='\x3cdiv style\x3d"padding: 10px;"\x3e'+
a+"\x3c/div\x3e";var c=b.advertiseOptions.url;if(c){let d=G();a=b.advertiseOptions.width;let e=b.advertiseOptions.height;c=SPRuntime.getURL("tooltip_advert.html?colorScheme\x3d"+encodeURIComponent(d)+"\x26url\x3d"+encodeURIComponent(c));a='\x3ciframe id\x3d"som-advert" scrolling\x3d"no" style\x3d"border:0; overflow:hidden; padding:0; border-radius: 10px; width:'+a+"px; height:"+e+'px;" allow\x3d"autoplay" allowfullscreen\x3d"true" src\x3d"'+c+'"\x3e\x3c/iframe\x3e'}b.somAdvertisement=new Opentip("#som-link",
a,{target:!0,showOn:null,hideTrigger:null,tipJoint:"bottom right",removeElementsOnHide:!0,borderWidth:0,borderRadius:10,shadowColor:"rgba(0, 0, 0, 0)",shadowOffset:[0,0],background:b.advertiseOptions.backgroundColor?b.advertiseOptions.backgroundColor:"#ffffff",stemLength:12,stemBase:15});c=void 0!==b.advertiseOptions.minShowTime?b.advertiseOptions.minShowTime:2E3;k.log("Advertise starting to show (minShowTime: "+c+"ms)");b.somAdvertisement.show();b.advertiseOptions.showTime=Date.now();b.advertiseTimeout=
setTimeout(function(){T("timed-out")},c)}}function T(a){if(b.somAdvertisement&&(b.advertiseTimeout&&(clearTimeout(b.advertiseTimeout),b.advertiseTimeout=void 0),b.somAdvertisement.hide(),b.somAdvertisement=void 0,b.advertiseOptions)){let c=Date.now()-b.advertiseOptions.showTime;if(b.advertiseOptions.onHide)b.advertiseOptions.onHide(c,a);a&&(b.advertiseOptions=void 0)}}function U(a,c,d,e,f){T();ua();L();let g="#som-link";b.showOnElementId&&(g="#"+b.showOnElementId);e&&(g="#"+e.id);let h="left";e&&
(h="bottom left");b.somTooltip=new Opentip(g,'\x3ciframe id\x3d"som-tooltip-frame" allowfullscreen\x3d"true" scrolling\x3d"no" style\x3d"border:0; overflow:hidden; width:'+c+"px; height:"+d+'px; border-radius: 10px;" allow\x3d"camera;microphone" src\x3d"'+a+'"\x3e\x3c/iframe\x3e',{target:!0,showOn:null,hideTrigger:null,tipJoint:h,removeElementsOnHide:!0,borderWidth:0,borderRadius:10,shadowColor:"rgba(0, 0, 0, 0.4)",shadowOffset:[2,2],background:"#0e1637",stemLength:12,stemBase:15});b.somTooltip.show();
a=document.getElementById("som-tooltip-frame");a.style.width=c+2+"px";a.style.height=d+2+"px";f||N()}function la(){let a=document.querySelector(".som-opentip-container");a&&(a.style.display="none")}function Yb(){let a=document.querySelector(".som-opentip-container");a&&(a.style.display="block")}function mb(){let a=document.querySelector(".som-opentip-container");return a?"none"===a.style.display:!1}function x(a){b.somTooltip&&(null===b.somLink.contentWindow||P()||Va(),b.somTooltip.hide(),b.somTooltip=
null,b.spPageIconTarget&&(a||(document.body.removeChild(b.spPageIconTarget),b.spPageIconTarget=void 0),da()),ca())}function xa(a,c,d,e,f,g){if(!b.previewEnabled)k.log("We're on page that is setup to NOT show preview so ignoring hover on link: "+c);else if((!b.waitingToShowPlayTip||b.waitingToShowPlayTipId!==f)&&b.somPlayId!==f&&b.somPlayLink!==c)if(document.getElementById("som-play-frame")&&Y(),"somup.com"===e){let l=function(m){(m=S(m.redirect))?xa(a,c,d,m[1],m[2],f):k.log("The somup link points to non-som upload so not showing popout.")};
f in b.popoutSomUpById?(g=b.popoutSomUpById[f],g.failed||l(g)):(b.waitingToShowPlayTipId=f,b.waitingToShowPlayTip=function(m){b.popoutSomUpById[f]=m;m.failed?k.log("Failed to get redirect for somup: "+f):(k.log("Got redirect for somup: "+m.redirect),l(m))},SPRuntime.sendMessageToBackground({getSomupRedirect:{id:f}}))}else{var h=function(l){if(l.id!==f)k.log("Callback id doesn't match expected so ignoring callback!  (data.id\x3d"+l.id+" id\x3d"+f+")");else{b.popoutDataById[f]=l;k.log("SOM tooltip play going to show.");
var m=l.resolution.split("x");l=parseInt(m[0]);m=parseInt(m[1]);var n=document.getElementById("som-play-target");n&&document.body.removeChild(n);var p=a.pageY,q=a.pageX;d&&(n=d.getBoundingClientRect(),p+=n.top,q+=n.left);n=document.createElement("div");n.id="som-play-target";n.style.opacity=0;n.style.pointerEvents="none";n.style.position="absolute";n.style.width="10px";n.style.height="1px";n.style.left=q+"px";n.style.top=p+"px";n.style.zIndex=2147483647;document.body.appendChild(n);var r=n.getBoundingClientRect();
q=Math.max(r.y,t.innerHeight-r.y);var u=Math.max(r.x,t.innerWidth-r.x);p=q!==r.y?"top":"bottom";p+=u!==r.x?"left":"right";r=Math.min(800,u-50);u=Math.min(800,q-46-60-50);q=l;r<q&&(q=r);r=m*q/l;u<r&&(r=u,q=l*r/m);l=SPRuntime.getURL("player.html?previewId\x3d"+f+"\x26host\x3d"+e+"\x26link\x3d"+(c&&c.href?c.href:""));b.somPlayTip=new Opentip(n,'\x3ciframe id\x3d"som-play-frame" scrolling\x3d"no" style\x3d"border:0; overflow:hidden; padding:0; border-radius: 10px; width:'+q+"px; height:"+(r+60+46)+'px;" allow\x3d"autoplay" allowfullscreen\x3d"true" src\x3d"'+
l+'"\x3e\x3c/iframe\x3e',{tipJoint:p,target:!0,fixed:!1,showOn:null,hideTrigger:null,removeElementsOnHide:!0,shadowColor:"rgba(0, 0, 0, 0.4)",shadowOffset:[0,0],borderRadius:10,borderWidth:0,background:"#181D3D",stemLength:12,stemBase:15});b.somPlayTip.show();b.somPlayId=f;b.somPlayLink=c;b.somPlayTarget=n;b.somPlayLinkShowTime=(new Date).getTime();N()}};f in b.popoutDataById?(b.waitingToShowPlayTipTimeout&&clearTimeout(b.waitingToShowPlayTipTimeout),b.waitingToShowPlayTipTimeoutId=g?g:f,b.waitingToShowPlayTipTimeout=
setTimeout(function(){h(b.popoutDataById[f])},500)):(b.waitingToShowPlayTipId=f,b.waitingToShowPlayTip=h,SPRuntime.sendMessageToBackground({getScreencastInfo:{host:e,id:f}}))}}function ya(a,c){b.waitingToShowPlayTipTimeoutId===c&&(clearTimeout(b.waitingToShowPlayTipTimeout),b.waitingToShowPlayTipTimeout=void 0,b.waitingToShowPlayTipTimeoutId=void 0);b.waitingToShowPlayTip&&b.waitingToShowPlayTipId===c&&(b.waitingToShowPlayTip=void 0,b.waitingToShowPlayTipId=void 0);null!=b.somPlayTip&&(c!==b.somPlayId&&
a!==b.somPlayLink?ka():(a=(new Date).getTime()-b.somPlayLinkShowTime,250>a?(k.log("Time elapsed is under a 250ms so hiding preview since mouse off.  (elapsed: "+a+"ms)"),ka()):document.addEventListener("mousedown",Y)))}function Y(){ka();document.removeEventListener("mousedown",Y)}function ka(){b.somPlayTip&&(b.somPlayTarget&&document.body.removeChild(b.somPlayTarget),b.somPlayTip.hide(),b.somPlayTip=null,b.somPlayId=null,b.somPlayLink=null,b.somPlayTarget=null)}function Da(){function a(g){let h=[g];
for(;g;g=g.parentNode)h.unshift(g);return h}function c(g,h,l){let m=h;if(void 0===l||""===l)l=h;h=0;for(let p of document.querySelectorAll(g)){a:{var n=p;g=a(b.somIframe?b.somIframe:b.somTextArea);n=a(n);if(g[0]===n[0])for(let q=0;q<g.length;q++)if(g[q]!==n[q]){g=q;break a}g=void 0}g>h&&(h=g,m=void 0!==p.value?p.value?p.value:l:p.innerText)}return m}function d(g,h,l){let m="";for(let n of document.querySelectorAll(g))g=n.innerText,""!==g&&(m+=""===m?g:h+g);return""===m?l:m}if(!1!==b.templateRecording)return b.templateRecording+
"-template";var e=D("defaultTitle");if(e)return e;e=document.title?document.title:"New Recording";var f=b.config.titleSelectors;if(f)for(let g of f)if(f=g.matchLocation,(new RegExp(f)).test(document.location)){k.log('Matched location to find title: "'+f+'"');g.defaultTitle&&"document.title"!==g.defaultTitle&&(e=g.defaultTitle);if(g.findFirst)for(let h of g.findFirst.selectors)if(f=c(h.selector,void 0,h.emptyValue))return k.log('Found title from selector: "'+h.selector+'" value: "'+f+'" isEmpty: '+
(f===h.emptyValue)),f;if(g.combineAll&&(f=d(g.combineAll.selector,g.combineAll.delimiter)))return k.log('Found combineAll from selector: "'+g.combineAll.selector+'" delimiter: "'+g.combineAll.delimiter+'" value:" '+f+'"'),f;k.log("No selectors match for title so using default: "+e)}return e}function Hb(a,c,d){function e(p){p=p||t.event;p.preventDefault();h=m-p.clientX;l=n-p.clientY;m=p.clientX;n=p.clientY;p=d(h,l);let q=g();var r=a.offsetTop,u=a.offsetLeft,w=a.offsetWidth,v=a.offsetHeight;r=(void 0!==
p.top?p.top:r)-r;u=(void 0!==p.left?p.left:u)-u;w=(void 0!==p.width?p.width:w)-w;v=(void 0!==p.height?p.height:v)-v;0!==r&&(0>q.top+r||0>q.bottom-r-v)||0!==u&&(0>q.left+u||0>q.right-u-w)||0!==w&&0>q.right-w-u||0!==v&&0>q.bottom-v-r||(void 0!==p.top&&(a.style.top=p.top+"px"),void 0!==p.left&&(a.style.left=p.left+"px"),void 0!==p.width&&(a.style.width=p.width+"px"),void 0!==p.height&&(a.style.height=p.height+"px"))}function f(){document.removeEventListener("mouseup",f);document.removeEventListener("mousemove",
e);if("absolute"===a.style.position){let p=g();a.style.position="fixed";a.style.top=p.top<p.bottom?p.top+"px":"auto";a.style.left=p.left<p.right?p.left+"px":"auto";a.style.right=p.right<=p.left?p.right+"px":"auto";a.style.bottom=p.bottom<=p.top?p.bottom+"px":"auto";k.log("div.style.top: "+a.style.top);k.log("div.style.left: "+a.style.left);k.log("div.style.right: "+a.style.right);k.log("div.style.bottom: "+a.style.bottom);b.pipState={width:a.style.width,height:a.style.height,fixedTop:a.style.top,
fixedBottom:a.style.bottom,fixedLeft:a.style.left,fixedRight:a.style.right};SPRuntime.sendMessageToBackground({pipState:b.pipState})}}function g(){var p=a.offsetTop,q=a.offsetLeft;let r=a.offsetWidth,u=a.offsetHeight,w=0<=navigator.platform.toUpperCase().indexOf("MAC"),v=document.documentElement.scrollWidth>document.documentElement.clientWidth,J=document.documentElement.scrollHeight>document.documentElement.clientHeight;p-=t.scrollY;q-=t.scrollX;return{top:Math.max(0,p),left:Math.max(0,q),right:Math.max(0,
t.innerWidth-q-r-(!w&&J?17:0)),bottom:Math.max(0,t.innerHeight-p-u-(!w&&v?17:0))}}let h=0,l=0,m=0,n=0;document.getElementById(a.id+"-"+c).onmousedown=function(p){if(!b.pipToggled){if("fixed"===a.style.position){let q=a.offsetTop,r=a.offsetLeft;a.style.position="absolute";a.style.top=q+t.scrollY+"px";a.style.left=r+t.scrollX+"px";a.style.right="auto";a.style.bottom="auto"}p=p||t.event;p.preventDefault();m=p.clientX;n=p.clientY;document.addEventListener("mouseup",f);document.addEventListener("mousemove",
e)}}}function G(){let a=getComputedStyle(document.documentElement).getPropertyValue("color-scheme"),c=getComputedStyle(document.body).getPropertyValue("color-scheme"),d=document.querySelector('meta[name\x3d"color-scheme"]')?document.querySelector('meta[name\x3d"color-scheme"]').content:void 0;return d?d:"normal"!==c?c:a}function A(a){return a?a.tagName+"."+a.id+"."+a.className:"NULL"}function Ka(){SPRuntime.sendMessageToBackground({initTab:!0,host:document.location.host,url:document.URL},function(a){if(a){a.spHost&&
(t.spHost=a.spHost);k.log("Init from background.");b.config=a.config;b.pipState=a.pipState;b.tabCaptureEnabled=a.tabCaptureEnabled;b.recorderEnabled=b.recorderEnabled&&a.recorderEnabled;b.pageIconEnabled=b.pageIconEnabled&&a.pageIconEnabled&&!a.openSlackRecorderUrl;b.previewEnabled=b.previewEnabled&&a.previewEnabled;b.linkExpandEnabled=b.linkExpandEnabled&&a.linkExpandEnabled;var c=b.config.showHideButton;if(c)for(var d of c)c=d.matchLocation,(new RegExp(c)).test(document.location)&&(k.log('Matched location for showing the hide button next to recorder: "'+
c+'": '+JSON.stringify(d)),b.showHideButton=d.show);b.tabCaptureEnabled&&!a.recordingInProgress?Ca(!0):b.pageIconEnabled&&Ca();if(d=b.config.convertTextLinks)for(var e of d)d=e.matchLocation,(new RegExp(d)).test(document.location)&&(k.log('Matched location for convert text links: "'+d+'": '+JSON.stringify(e)),e.enabled&&(b.convertTextLinksConfig=e));e=b.config.unfurlWatchUrls;b.unfurlWatchUrlsConfig=void 0;if(e)for(var f of e)e=f.matchLocation,(new RegExp(e)).test(document.location)&&(k.log('Matched location for unfurling watch urls: "'+
e+'": '+JSON.stringify(f)),f.enabled&&(b.unfurlWatchUrlsConfig=f));if(f=b.config.adverts)for(let g of f){let h=void 0!==g.version?g.version:0,l=g.matchLocation,m="sp-advert-shown-"+l+"-v"+h;(new RegExp(l)).test(document.location)&&(k.debug('Matched location for advert: "'+l+'": '+JSON.stringify(g)),m+="-"+(g.flyout?"flyout":"tooltip"),localStorage.getItem(m)?k.debug('Matched location for advert that has ALREADY been shown: "'+m+'"'):g.flyout?(k.log('Advert flyout showing: "'+m+'"'),setTimeout(function(){Ib(g).spRemovedCallback=
function(){k.log('Advert flyout shown so setting local storage to not show again: "'+m+'"');localStorage.setItem(m,"1")}},1E3)):g.tooltip&&(g.tooltip.onHide=(n,p)=>{!SPRuntime.isEmbed()&&(p||1E3<n)&&SPRuntime.sendMessageToBackground({reportEvent:"AppInAppMessage",props:{matchlocation:l,advertVersion:h,timeShownSec:n/1E3,result:p?p:"none"}});p&&(k.log('Advert tooltip shown so setting local storage to not show again: "'+m+'"'),localStorage.setItem(m,"1"))},b.advertise(g.tooltip)))}b.recordingInProgress=
a.recordingInProgress;a.openSlackRecorderUrl&&(k.log("Got openSlackRecorderUrl on init so reopening recorder in tab."),Ua(a.openSlackRecorderUrl),a.openSlackNavigated&&Zb("message_recorder_opened_"+a.openSlackNavigated+".html"));oa();(a=Qa())&&a.selector&&(a=document.querySelector(a.selector))&&Z(a)&&(a.focus(),setTimeout(()=>{L();b.ignorePosition=!0;setTimeout(function(){b.ignorePosition=!1;ca()},5E3)},1E3))}else k.log("Init from background returned UNDEFINED.")})}function Zb(a){fa();var c=G();a+=
-1!==a.indexOf("?")?"\x26":"?";a=SPRuntime.getURL(a+"colorScheme\x3d"+encodeURIComponent(c));c=document.createElement("iframe");c.id="sp-message-box";c.allow="camera;microphone";c.style.position="fixed";c.style.width=0;c.style.height=0;c.style.top="0px";c.style.left="50%";c.style.transform="translate(-50%, 0)";c.style.border=0;c.style.zIndex=2147483647;c.style.visibility="visible";c.style.display="block";c.scrolling="no";c.src=a;a=document.body.appendChild(c);k.log("Added message box with result: "+
JSON.stringify(a))}function $b(a){let c=document.getElementById("sp-message-box");c&&(c.style.width=a.messageBoxResize.width+"px",c.style.height=a.messageBoxResize.height+"px")}function fa(){let a=document.getElementById("sp-message-box");a&&document.body.removeChild(a)}function ac(){let a=/api\/sp\.js/i,c=document.getElementsByTagName("script");for(let d=0;d<c.length;d++){let e=c[d].getAttribute("src");if(a.test(e))return!0}return!1}function E(a){k.log("SP showting template guide.");Ga("sp-template-guide-frame",
"templateGuide.html?type\x3d"+a,565,260);SPRuntime.sendMessageToBackground({reportEvent:"AppUserMessage",props:{type:"template-guide-"+a}})}function bc(a){k.log("SOM going to ask if user wants to record this tab or other.");Ga("som-check-which-frame","checkWhich.html?type\x3d"+a,565,240)}function cc(){k.log("Going to show light box to choose effects");let a=Math.min(771,t.innerWidth-40),c=Math.min(700,t.innerHeight-40);ja(!0);Ga("som-effects-menu","effects_menu.html",a,c)}function Ga(a,c,d,e){B(!0);
c=SPRuntime.getURL(c);Ea('\x3ciframe id\x3d"'+a+'" scrolling\x3d"no" allowfullscreen\x3d"true" style\x3d"border:0; overflow:hidden; width:'+d+"px; height:"+e+'px; border-radius: 15px;" src\x3d"'+c+'"\x3e\x3c/iframe\x3e');let f=document.getElementsByClassName("som-basicLightbox__placeholder")[0];b.somMutationObserverLightbox=new MutationObserver(function(){1<f.childNodes.length&&f.removeChild(f.childNodes[1])});b.somMutationObserverLightbox.observe(f,{childList:!0,subtree:!0})}function R(a){if(void 0===
a||b.lightboxHtml===a)b.lightbox&&b.lightbox.visible()&&(b.somMutationObserverLightbox&&b.somMutationObserverLightbox.disconnect(),b.lightbox.close(),b.lightbox=void 0),b.templateTimedOutTimer&&(clearTimeout(b.templateTimedOutTimer),b.templateTimedOutTimer=void 0)}function Ea(a){R();b.lightboxHtml=a;b.lightbox=basicLightbox.create(a,{closable:!1});b.lightbox.show();a=document.getElementsByClassName("som-basicLightbox");1===a.length&&(a[0].style.zIndex=2147483646)}function dc(a,c,d){a.hasOwnProperty("spHighlights")||
(a.spHighlights=[]);a.spHighlights.push({text:c,url:d,elements:[],isOverElement:!1})}function Aa(a,c){if(a.hasOwnProperty("spHighlights")){var d=y(a)?a:ec(a),e=fc(a);gc(a,d,e,c);a.spTextOverlayScroll.scrollTop=a.scrollTop}}function ec(a){if(a.hasOwnProperty("spMirror")&&a.spMirror.spTextArea===a)return a.spMirror.textContent=a.value,a.spMirror;let c=null!=t.mozInnerScreenX,d=0<=navigator.platform.toUpperCase().indexOf("MAC"),e=document.getElementById("som-mirror");e&&document.body.removeChild(e);
e=document.createElement("div");e.id="som-mirror";document.body.appendChild(e);e.spTextArea=a;a.spMirror=e;let f=e.style,g=getComputedStyle(a);f.whiteSpace="pre-wrap";f.wordWrap="break-word";f.position="fixed";f.top="0px";f.left="0px";f.visibility="hidden";"boxSizing width height overflowX overflowY borderTopWidth borderRightWidth borderBottomWidth borderLeftWidth borderTopStyle borderRightStyle borderBottomStyle borderLeftStyle paddingTop paddingRight paddingBottom paddingLeft fontStyle fontVariant fontWeight fontStretch fontSize lineHeight fontFamily textAlign textTransform textIndent textDecoration letterSpacing wordSpacing".split(" ").forEach(function(h){f[h]=
g[h]});c?(f.width=parseInt(g.width)-2+"px",a.scrollHeight>parseInt(g.height)&&(f.overflowY="scroll")):(!d&&a.clientHeight<a.scrollHeight&&"content-box"!==g.boxSizing&&(f.width=parseInt(g.width)-16+"px"),f.overflow="hidden");e.textContent=a.value;return e}function nb(a){a.hasOwnProperty("spMirror")&&a.spMirror.spTextArea===a&&(document.body.removeChild(a.spMirror),delete a.spMirror);if(a.hasOwnProperty("spTextOverlayContainer"))for(a=a.spTextOverlayContainer.spOverlaysParent;a.firstChild;)a.removeChild(a.firstChild)}
function fc(a){if(a.hasOwnProperty("spTextOverlayContainer")){for(var c=a.spTextOverlayContainer.spOverlaysParent;c.firstChild;)c.removeChild(c.firstChild);c=a.getBoundingClientRect();a.spTextOverlayScroll.style.width=c.width+"px";a.spTextOverlayScroll.style.height=c.height+"px";a.spTextOverlayContainer.spOverlaysParent.style.width=c.width;a.spTextOverlayContainer.style.top="0px";a.spTextOverlayContainer.style.left="0px";var d=a.spTextOverlayContainer.getBoundingClientRect(),e=c.left-d.left;a.spTextOverlayContainer.style.top=
c.top-d.top+"px";a.spTextOverlayContainer.style.left=e+"px";return a.spTextOverlayContainer.spOverlaysParent}c=a.getBoundingClientRect();d=a.scrollTop;a.hasOwnProperty("spOrigScrollTop")&&a.spOrigScrollTop&&(d=a.spOrigScrollTop,a.spOrigScrollTop=void 0);e=a.ownerDocument.createElement("div");e.style.position="absolute";e.style.top="0px";e.style.left="0px";e.style.pointerEvents="none";e.style.margin="0";e.style.padding="0";e.style.border="0";a.parentNode.insertBefore(e,a);a.spTextOverlayContainer=
e;let f=e.getBoundingClientRect(),g=c.left-f.left;e.style.top=c.top-f.top+"px";e.style.left=g+"px";let h=a.ownerDocument.createElement("div");h.style.position="relative";h.style.pointerEvents="none";h.style.boxSizing="content-box";h.style.top="1px";h.style.left="1px";h.style.width=c.width+"px";h.style.height=c.height+"px";h.style.overflow="hidden";h.style.border=0;h.style.padding=0;h.style.margin=0;h.scrollTop=d;e.appendChild(h);a.spTextOverlayScroll=h;d=a.ownerDocument.createElement("div");d.style.position=
"absolute";d.style.top="0px";d.style.left="0px";d.style.pointerEvents="none";d.style.margin="0";d.style.padding="0";d.style.border="0";h.appendChild(d);e=a.ownerDocument.createElement("div");e.style.width=c.width;e.style.height="3000px";e.style.pointerEvents="none";e.style.margin="0";e.style.padding="0";e.style.border="0";d.appendChild(e);a.spTextOverlayContainer.spOverlaysParent=e;C(a,"scroll",function(){h.scrollTop=a.scrollTop});return e}function gc(a,c,d,e){let f=a.spHighlights,g=c.getBoundingClientRect();
for(c=a.ownerDocument.createTreeWalker(c,NodeFilter.SHOW_TEXT);c.nextNode();){let q=c.currentNode;for(let r of f){var h=r.text,l=q.textContent.indexOf(h);if(-1!==l){var m=a.ownerDocument.createRange();h=l+h.length;m.setStart(q,l);m.setEnd(q,h);l=m.getClientRects();k.log("Client Rects: "+JSON.stringify(l));r.elements=[];r.isOverElement=!1;for(let u of l)l=u.top-g.top,m=u.left-g.left,h=a.ownerDocument.createElement("div"),h.classList.add("sp-highlight"),h.style.position="absolute",h.style.top=l+"px",
h.style.left=m+"px",h.style.width=u.width+"px",h.style.height=u.height-2+"px",h.style.borderBottom="3px solid rgba(0, 0, 255, 0.5)",h.style.margin="0",h.style.padding="0",r.elements.push(h),d.appendChild(h)}}}var n=null,p=null;a.addEventListener("mousemove",function(q){let r=q.clientX,u=q.clientY;for(let v of f){let J=!1;for(let z of v.elements){var w=z.getBoundingClientRect();if(r>=w.x&&r<w.x+w.width&&u>=w.y&&u<w.y+w.height){J=!0;break}}if(v.isOverElement!==J){for(let z of v.elements)z.style.background=
J?"rgba(0, 0, 255, 0.2)":"none";w=v.elements[0];if(J){let z=S(v.url);z&&(v.host=z[1],v.id=z[2],n=w,p=v.id,xa(q,w,e,v.host,v.id))}else p=n=null,ya(w,v.id)}v.isOverElement=J}});a.addEventListener("mouseout",function(q){for(let r of f){for(let u of r.elements)u.style.background="none";r.isOverElement=!1}n&&(ya(n,p),p=n=null)})}function hc(a,c){var d=vb();let e=d.width,f=d.height;d={width:d.videoWidth,height:d.videoHeight};if(a)for(var g in a)d[g]=a[g];b.browserRecorderDone=c;b.channelId=a.channelId;
R();c="browser-recorder/recorder.html";a.branded&&(c="recorder.html");a=SPRuntime.getURL(c+"?"+(new URLSearchParams(d)).toString());b.lightbox=basicLightbox.create('\x3cdiv id\x3d"som-recorder-frame-container" style\x3d"width:'+e+"px; height:"+f+'px;"\x3e\x3ciframe id\x3d"som-recorder-frame" allow\x3d"display-capture;camera;microphone" scrolling\x3d"no" allowfullscreen\x3d"true" style\x3d"border:0; overflow:hidden; width:100%; height:100%; border-radius: 5px;" src\x3d"'+a+'"\x3e\x3c/iframe\x3e\x3c/div\x3e',
{closable:!1});b.lightbox.show();let h=l=>{l=vb();if(l.width!==e||l.height!==f){e=l.width;f=l.height;let m=document.getElementById("som-recorder-frame-container");m?(m.style.width=e+"px",m.style.height=f+"px",document.getElementById("som-recorder-frame").contentWindow.postMessage({resized:l},"*")):t.removeEventListener("resize",h)}};t.addEventListener("resize",h);B(!0);ha()}function vb(){var a=t.innerWidth,c=t.innerHeight;let d=1280;a<d+151&&(d=a-151);a=720*d/1280;c<a+227&&(a=c-227,d=1280*a/720);
c=d+151;950>c&&(c=950);return{width:c,height:a+227,videoWidth:d,videoHeight:a}}function ic(a){var c=document.getElementById("som-recorder-frame-container");if(c)if(a){a=document.createElement("div");a.id="som-browser-rec-controls-hint";a.style.position="absolute";a.style.top="0";a.style.left="0";a.style.textAlign="center";a.style.zIndex=2147483647;a.style.padding="15px 0";a.style.color="white";a.style.width="100%";a.style.fontFamily="Arial";a.style.fontSize="14px";a.innerHTML='\x3cb\x3eHint:\x3c/b\x3e Use \x3csvg width\x3d"14px" height\x3d"14px" viewBox\x3d"0 0 14 14" version\x3d"1.1" xmlns\x3d"http://www.w3.org/2000/svg" xmlns:xlink\x3d"http://www.w3.org/1999/xlink"\x3e\n    \x3ctitle\x3eArrow-up\x3c/title\x3e\n    \x3cg id\x3d"Symbols" stroke\x3d"none" stroke-width\x3d"1" fill\x3d"none" fill-rule\x3d"evenodd"\x3e\n        \x3cg id\x3d"attention-to-chrome-tab" transform\x3d"translate(-775, -8)" fill\x3d"#F7B500" fill-rule\x3d"nonzero"\x3e\n            \x3cg id\x3d"Arrow-up" transform\x3d"translate(775.0808, 8)"\x3e\n                \x3cpath d\x3d"M0.109840131,7.1843243 L0.728582552,7.80303621 C0.875005543,7.9494592 1.11243173,7.9494592 1.25891576,7.80303621 L6.10668252,2.95523893 L6.10668252,13.6249523 C6.10668252,13.832044 6.27458984,13.9999514 6.48168163,13.9999514 L7.35667954,13.9999514 C7.56377133,13.9999514 7.73167865,13.832044 7.73167865,13.6249523 L7.73167865,2.95523893 L12.5794759,7.80303621 C12.7259294,7.9494592 12.9633556,7.9494592 13.1098091,7.80303621 L13.7285516,7.1843243 C13.8749745,7.03787079 13.8749745,6.8004446 13.7285516,6.65396058 L7.18434719,0.109817243 C7.03789368,-0.0366057477 6.80046749,-0.0366057477 6.65398346,0.109817243 L0.109840131,6.65399109 C-0.0366133771,6.8004446 -0.0366133771,7.03787079 0.109840131,7.1843243 Z" id\x3d"Path"\x3e\x3c/path\x3e\n            \x3c/g\x3e\n        \x3c/g\x3e\n    \x3c/g\x3e\n\x3c/svg\x3e "View tab" button to toggle between this tab and the one you are recording.';
document.body.appendChild(a);a=a.getBoundingClientRect().height+10;let d=t.innerHeight-c.getBoundingClientRect().height;d<a&&(a-=d,c.style.marginTop=a+"px")}else c.style.marginTop="0",(c=document.getElementById("som-browser-rec-controls-hint"))&&document.body.removeChild(c)}function C(a,c,d,e){a.addEventListener(c,d);b.runOnUnload.push(()=>{a.removeEventListener(c,d);e&&e()})}function Ma(a){let c=new MutationObserver(a);b.runOnUnload.push(()=>{c.disconnect()});return c}function wb(a,c){try{localStorage.setItem(a,
c)}catch(d){k.debug("User has security setup so we are failing to set local storage '"+a+"' \x3d "+c+": "+d)}}if(SPRuntime.isEmbed()||t.top===t.self)if(!SPRuntime.isEmbed()&&ac())t.SPBailOnExtension=!0;else{var Ab=["https://screenpal.com/get-browser-extension","https://chromewebstore.google.com/detail/screenpal-screen-recorder/eefedolmcildfckjamddopaplfiiankl","https://chromewebstore.google.com/detail/screenpal-screen-recorder/mgikkebdjbjnlfehgnkdkboiecgjnaon"],jc=-1!==navigator.userAgent.toLowerCase().indexOf("firefox"),
kc=K("\x3c\x3c\x3c ScreenPal - Video link will go here \x3e\x3e\x3e"),lc="\x3cdiv\x3e"+K("\x3c\x3c\x3c ScreenPal - Video link will go here \x3e\x3e\x3e")+"\x3c/div\x3e",mc=D("enableRecorder",!0),nc=D("enablePageIcon",!SPRuntime.isEmbed()),oc=D("enablePreview",!0),pc=D("linkExpand",!0),Ha;if(!(Ha=SPRuntime.isDebug())){a:{try{var xb=localStorage.getItem("SP-DEBUG");break a}catch(a){k.debug("User has security setup so we are failing to access local storage: "+a)}xb="false"}Ha="true"===xb}var b={isFirefox:jc,
recordingInProgressPlaceHolderText:"\x3c\x3c\x3c ScreenPal - Video link will go here \x3e\x3e\x3e",recordingInProgressPlaceHolderHtmlNoThumbnail:kc,recordingInProgressPlaceHolderHtmlWithThumbnail:lc,popoutDataById:{},popoutSomUpById:{},chuckUnfurlDataById:{},waitingForCheckUnfurlById:{},pipToggled:!1,pipGoBigButtonIcon:'\x3c?xml version\x3d"1.0" ?\x3e\x3csvg id\x3d"Arrows" viewBox\x3d"0 0 24 24" xmlns\x3d"http://www.w3.org/2000/svg"\x3e\x3cdefs\x3e\x3cstyle\x3e.cls-1{fill:none;stroke:#FFF;stroke-linecap:round;stroke-linejoin:round;}\x3c/style\x3e\x3c/defs\x3e\x3ctitle/\x3e\x3cpolyline class\x3d"cls-1" points\x3d"19.5 7.5 19.5 3.5 15.5 3.5"/\x3e\x3cpolyline class\x3d"cls-1" points\x3d"3.5 15.5 3.5 19.5 7.5 19.5"/\x3e\x3cline class\x3d"cls-1" x1\x3d"14.5" x2\x3d"19.5" y1\x3d"8.5" y2\x3d"3.5"/\x3e\x3cline class\x3d"cls-1" x1\x3d"3.5" x2\x3d"8.5" y1\x3d"19.5" y2\x3d"14.5"/\x3e\x3cpolyline class\x3d"cls-1" points\x3d"3.5 7.5 3.5 3.5 7.5 3.5"/\x3e\x3cpolyline class\x3d"cls-1" points\x3d"19.5 15.5 19.5 19.5 15.5 19.5"/\x3e\x3cline class\x3d"cls-1" x1\x3d"8.5" x2\x3d"3.5" y1\x3d"8.5" y2\x3d"3.5"/\x3e\x3cline class\x3d"cls-1" x1\x3d"19.5" x2\x3d"14.5" y1\x3d"19.5" y2\x3d"14.5"/\x3e\x3c/svg\x3e',
pipGoSmallButtonIcon:'\x3c?xml version\x3d"1.0" ?\x3e\x3csvg data-name\x3d"Layer 1" id\x3d"Layer_1" viewBox\x3d"0 0 24 24" xmlns\x3d"http://www.w3.org/2000/svg"\x3e\x3ctitle/\x3e\x3cpath fill\x3d"#ffffff" d\x3d"M9.63,4.89V9A.62.62,0,0,1,9,9.63H4.89a.62.62,0,0,1,0-1.24H7.52L2.18,3.06a.62.62,0,0,1,.87-.87L8.39,7.52V4.89a.62.62,0,1,1,1.24,0ZM19.73,9a.62.62,0,0,0-.62-.62H16.48l5.34-5.34a.62.62,0,0,0-.87-.87L15.61,7.52V4.89a.62.62,0,0,0-1.24,0V9a.62.62,0,0,0,.62.62h4.12A.62.62,0,0,0,19.73,9ZM15,19.73a.62.62,0,0,0,.62-.62V16.48l5.34,5.34a.62.62,0,0,0,.87-.87l-5.34-5.34h2.63a.62.62,0,1,0,0-1.24H15a.62.62,0,0,0-.62.62v4.12A.62.62,0,0,0,15,19.73ZM4.27,15a.62.62,0,0,0,.62.62H7.52L2.18,20.94a.62.62,0,0,0,.87.87l5.34-5.34v2.63a.62.62,0,0,0,1.24,0V15A.62.62,0,0,0,9,14.37H4.89A.62.62,0,0,0,4.27,15Z"/\x3e\x3c/svg\x3e',
recorderEnabled:mc,pageIconEnabled:nc,previewEnabled:oc,linkExpandEnabled:pc,logText:"",debugging:Ha,lastTooltipRecInfo:{recId:0},convertTextLinksConfig:null,checkElementsTimeout:void 0,positionTimeout:void 0,positionTimeoutTime:0,ignorePosition:!1,ignoreMutation:!1,showOnElementId:null,advertiseOptions:void 0,advertiseTimeout:void 0,showHideButton:!0,closeHideButton:function(){},bgIsDark:void 0,runOnUnload:[],tabCaptureEnabled:!1,editingAbandonedRecording:!1,templateRecording:!1,editorResizeListener:void 0,
onAdvertisementShown:function(){},onStartRecording:function(){},onCancelRecording:function(){b.templateFunc=void 0},onDoneRecording:function(a){let c=a.title,d=a.playUrl;a=a.gifUrl;if(b.templateRecording)b.templatePlayUrl=d,b.templateShareUrl=a,E("waiting"),SPRuntime.sendMessageToBackground({generateAi:b.templateRecording,playUrl:d}),b.templateTimedOutTimer=setTimeout(()=>{void 0!==b.lightbox&&E("timed-out")},12E4);else if(b.editingAbandonedRecording)k.log("Handling an abandoned recordings so copying recording url to clipboard and showing flyout. (url: "+
d+")"),H(d),va(d,c,a);else{var e=b.recordingStarted.textArea,f=b.recordingStarted.iframe,g=b.recordingStarted.injectInfo,h=y(e);if(e&&0<e.getBoundingClientRect().width){let l=void 0;g.isMarkdown?(k.log("Injecting recording url in markdown text area. (url: "+d+")"),l=Qb(e,g,d,a)):g.forceTextOnly||g.forceTextLink||!a?g.forceTextOnly&&h?(k.log("Injecting text in content editable. (url: "+d+")"),V(e,g,d),l=d):h?(k.log("Injecting recording url as text link in content editable. (url: "+d+")"),gb(e,g,d)):
(k.log("Injecting recording url in text area. (url: "+d+")"),V(e,g,d),l=d):(k.log("Injecting recording url with thumbnail in content editable. (url: "+d+")"),gb(e,g,d,a,c));l&&(dc(e,l,d),setTimeout(function(){Aa(e,f);e.hasOwnProperty("spOnChangeListener")||(e.spOnChangeListener=function(){Aa(e,f)},C(e,"input",e.spOnChangeListener,()=>{delete e.spOnChangeListener}))},500))}else k.log("TextArea is gone! Copying recording url to clipboard. (url: "+d+")"),H(d),k.log("Showing flyout to notify user we copied url..."),
va(d,c,a)}}},k=function(){function a(e,f){SPRuntime.sendMessageToBackground({logMessage:{type:e,text:f,page:document.location.host}})}function c(e,f){var g=new Date;let h=6E4*g.getTimezoneOffset();g=(new Date(g.getTime()-h)).toISOString().slice(0,19).replace(/-/g,"/").replace("T"," ");b.logText+=g+" "+e.toUpperCase()+": "+f+"\n";d()}function d(){if(b.debugging){var e=b.logText.split("\n");for(let f of e)""!==f&&console.log(f);b.logText=""}}return{debug:function(e){b.debugging&&c("DEBUG",e)},log:function(e){c("INFO",
e)},logToBackground:function(e){c("INFO",e);a("DEBUG",e)},error:function(e){c("ERROR",e);let f=Error().stack.split("\n"),g=3,h="";for(let l of f)g--||(h+=l+"\n");b.logText+=h;d();a("ERROR",e+h)}}}();k.log("SPMain Added (location: "+document.location+")");Ja();SPRuntime.isEmbed()||t.addEventListener("message",a=>{a.source===t&&a.data&&a.data.command&&!a.data.result&&(t.location.hostname.endsWith(".screenpal.com")||"screenpal.com"===t.location.hostname?(console.log("Got command from webpage: "+a.data.command),
a.data.result="unknown","open-recorder"===a.data.command?b.recordingInProgress||P()?a.data.result="already-open":(I("launcher",void 0,"NO_FOLDER_RECORD_IN_BROWSER"),a.data.result="success"):"check-install"===a.data.command&&(a.data.result="success"),a.source.postMessage(a.data,a.origin)):console.log("We're not on a screenpal.com page so ignoring message: "+JSON.stringify(a.data)))});SPRuntime.startMessageListener(k,function(a){if(a.backgroundReady)k.log("Background is ready."),Ka();else if(a.historyStateUpdate)k.log("Got historyStateUpdate"),
na();else if(a.needHelp)k.log("User asking for help."),N(),ea("popup_menu_needhelp.html?type\x3dstand-alone");else if(a.popupMenu)k.log("Got popup menu action: "+a.popupMenu),"toggle"===a.popupMenu?N()||ea():"open"===a.popupMenu?ea():"close"===a.popupMenu&&N();else if(a.launcherMenu){k.log("Got launcherMenu action: "+a.launcherMenu);var c=()=>{ea("popup_menu_launcher.html",{width:345,height:100})};let d=()=>{let e=N();e&&!b.pageIconEnabled&&(x(),B(!0));return e};"toggle"===a.launcherMenu?d()||c():
"open"===a.launcherMenu?c():"close"===a.launcherMenu?d():"settings"===a.launcherMenu?(N(),ea()):"record"===a.launcherMenu&&(N(),b.recordingInProgress||P()?k.log("Ignoring request to open recorder from launcher menu since we're already recording."):(b.tabCaptureEnabled=!0,I("launcher",void 0,"NO_FOLDER_RECORD_IN_BROWSER")))}else if(a.openRecorder)b.recordingInProgress||P()?k.log("Ignoring request to open recorder from context-menu since we're already recording."):I("context-menu");else if(a.resizeMenu)k.log("Got resizeMenu action: "+
JSON.stringify(a.resizeMenu)),Vb(a.resizeMenu);else if(a.settings)k.log("User asked to see settings"),x(),Xb();else if(a.effects_setup)k.log("User asked to see effects setup"),x(),Wb();else if(a.settingsBack)k.log("User asked to go back to tooltip after settings"),x(),tb();else if(a.canceled)a:{if(k.log("Upload canceled so closing tip."),b.tabCaptureEnabled&&(b.tabCaptureEnabled=!1,SPRuntime.sendMessageToBackground({cancelTabCapture:!0})),"setup"===b.recordingInProgress&&!a.reboot&&(k.log("Cancel from the chrome dialog so we can restart recorder."),
b.recordingInProgress=!1,P("tooltip_choose_what_to_record"))){Q();R();I("reopen-after-cancel");break a}b.onCancelRecording&&(b.onCancelRecording(),b.onCancelRecording=void 0);aa();x();Q();Fa()}else if(a.showEdit)b.editingAbandonedRecording=!0,sb(a.editVideoSrcUrl,a.resolution,a.durationMS,a.hasAudio);else if(a.done)if(k.log("Upload done so closing tip. (done: "+a.done+")"),x(),Q(),Fa(),O(),b.recordingStarted||b.editingAbandonedRecording)if("success"===a.done){c={title:a.title,duration:a.durationMS,
playUrl:a.playUrl};a.sharePreviewUrl&&(c.gifUrl=a.sharePreviewUrl);if(b.onDoneRecording)b.onDoneRecording(c);aa()}else"edit"===a.done?sb(a.editVideoSrcUrl,a.resolution,a.durationMS,a.hasAudio):"error"===a.done?(aa(),ub("Error processing recording.")):aa();else"edit"!==a.done&&(b.recordingInProgress=!1);else if(a.failed)k.error("Recording failed so closing tip."),c=b.somTooltip,aa(),x(c),Q(),Fa(),c&&ub(a.error,b.spPageIconTarget);else if(a.floatResize)Nb(a);else if(a.messageBoxResize)$b(a);else if(a.closeMessageBox)fa();
else if(a.navigate)document.location=a.navigate;else if(a.floatControls)"both-monitor"===a.type||"both-window"===a.type?la():x(),b.recordingInProgress=!0,ia(a.floatControls),a.pip&&"recStop"!==a.lastAction&&ta("recPause"!==a.lastAction),B(!0);else if(a.starting){"both-window"===a.type&&(k.log("User trying to capture both window and webcam, so see if they choose chrome."),setTimeout(function(){document.querySelector(":hover")?(k.log("User DID choose chrome window to capture so activate PIP in all tabs!"),
SPRuntime.sendMessageToBackground({pipActiveInAllTabs:!0}),ta(!0),x()):k.debug("User DIDN'T choose this chrome window so nothing is hovered.")},500));"both-monitor"!==a.type&&bb();parseInt(a.recId)===b.lastTooltipRecInfo.recId&&(b.recordingStarted={playUrl:a.url,textArea:b.lastTooltipRecInfo.somTextArea,iframe:b.lastTooltipRecInfo.somIframe,injectInfo:b.lastTooltipRecInfo.injectInfo,type:a.type},b.lastTooltipRecInfo.somTextArea&&(c=b.recordingInProgressPlaceHolderText,y(b.lastTooltipRecInfo.somTextArea)&&
!b.lastTooltipRecInfo.injectInfo.forceTextOnly&&(c=a.useThumbnail?b.recordingInProgressPlaceHolderHtmlWithThumbnail:b.recordingInProgressPlaceHolderHtmlNoThumbnail),eb(b.lastTooltipRecInfo.somTextArea,b.lastTooltipRecInfo.injectInfo,c)));b.recordingInProgress=!0;b.editingAbandonedRecording=!1;da();if(b.onStartRecording)b.onStartRecording();b.templateRecording&&E(b.templateRecording+"-in-progress")}else if(a.cancelling)b.onCancelRecording&&(b.onCancelRecording(),b.onCancelRecording=void 0);else if(a.tooltipRecServiceAction)"recStop"===
a.tooltipRecServiceAction&&(b.recordingStarted||Q(),O()),b.templateRecording&&("recPause"===a.tooltipRecServiceAction||"recStop"===a.tooltipRecServiceAction?E(b.templateRecording+"-paused"):"recResume"===a.tooltipRecServiceAction&&E(b.templateRecording+"-in-progress"));else if(a.closeTooltip)x();else if(a.closePlayTooltip)Y();else if(a.hideTooltip)la();else if(a.unhideTooltip)Yb();else if(a.inPageReady)la(),c={type:"setup_inpage",recId:b.lastTooltipRecInfo.recId,tabCaptureEnabled:b.tabCaptureEnabled,
templateRecording:!1!==b.templateRecording,maxTimeMS:a.maxTimeMS,host:document.location.host,defaultTitle:Da()},ia("som_rec_controls.html?"+(new URLSearchParams(c)).toString());else if(a.inPageScreenRecStarting)a.popoutOpen?Kb():ja(!0),a.tabCaptureRecording||(Ea(""),B(!0),ia("tooltip_choose_what_to_record.html?type\x3dsetup_inpage")),fa();else if(a.closeFlyout)ua();else if(a.showAdvert)Jb(a);else if(a.notRecordingTab)b.recordingStarted&&(x(),O());else if(a.showFlyout)a.url&&(k.log("Copying url and showing flyout since we're active. (url: "+
a.url+")"),H(a.url),va(a.url,a.title));else if(a.addPIPFrame)ta();else if(a.removePIPFrame)O();else if(a.forceBigPIPFrame)b.pipToggled!==a.setting&&($a(),b.pipToggled?document.getElementById("som-pip-frame-container").classList.add("big-forced"):document.getElementById("som-pip-frame-container").classList.remove("big-forced"),b.updatePIP&&b.updatePIP(b.pipToggled));else if(a.showPIPFrame)Za();else if(a.pipState)b.pipState=a.pipState,ab();else if(void 0!==a.drawing)"start"===a.drawing?Fb(a):"stop"===
a.drawing?Xa():"update"===a.drawing&&Gb(a);else if(void 0!==a.effects)"toggle"===a.effects?Eb(a.num,a.transitionIn,a.transitionOut):"stop"===a.effects&&sa(a.transitionOut);else if(void 0!==a.drawingActive)cb();else if(void 0!==a.slideOutFloatingControls)cb();else if(void 0!==a.slideInFloatingControls)Mb();else if(void 0!==a.setWhiteboard)a.set?Db():ha();else if(a.getScreencastInfo)b.waitingToShowPlayTip&&(a.getScreencastInfo.id===b.waitingToShowPlayTipId?(c=b.waitingToShowPlayTip,b.waitingToShowPlayTip=
void 0,b.waitingToShowPlayTipId=void 0,c(a.getScreencastInfo)):k.log("Ignoring getScreencastInfo callback since we have a different id waiting."));else if(void 0!==a.templateMenu)"onmousemove"===a.templateMenu?(L(),b.ignoreMutation=!0,setTimeout(function(){b.ignoreMutation=!1},3E3)):b.somTemplateMenu&&(Bb(b.somTemplateMenu[a.templateMenu]),setTimeout(()=>{b.somTextArea&&F(b.somTextArea)},100));else if(a.aiStatus)k.log("Got ai status: "+a.aiStatus),"ready"===a.aiStatus?(b.templateFunc&&(b.templateFunc(a.info),
b.templateFunc=void 0),R(),B(!1),ja(!1)):"error"===a.aiStatus?E("error"):"not-enabled"===a.aiStatus&&E("not-enabled-"+a.sessionAiStatus);else if(a.templateVideoUploading)Q();else if(a.templateVideoUploaded)b.templateRecording&&(b.templatePlayUrl=a.templateVideoUploaded,E("waiting"),SPRuntime.sendMessageToBackground({generateAi:b.templateRecording,playUrl:a.templateVideoUploaded}));else if(a.getSomupRedirect)b.waitingToShowPlayTip&&(a.getSomupRedirect.id===b.waitingToShowPlayTipId?(c=b.waitingToShowPlayTip,
b.waitingToShowPlayTip=void 0,b.waitingToShowPlayTipId=void 0,c(a.getSomupRedirect)):k.log("Ignoring getSomupRedirect callback since we have a different link waiting."));else if(a.checkUnfurlUrl)if(b.waitingForCheckUnfurlById[a.checkUnfurlUrl.id])b.waitingForCheckUnfurlById[a.checkUnfurlUrl.id](a.checkUnfurlUrl.data);else k.log("Got checkUnfurlUrl result but nothing waiting on id: "+a.checkUnfurlUrl.id);else if(void 0===a.fullscreenCountDown)if(void 0!==a.pipUnsupported)O();else if(void 0!==a.domainSettings)document.location.host===
a.domain&&(void 0!==a.recorderEnabled&&(k.log("Updating domain recorderEnabled: "+a.recorderEnabled),b.recorderEnabled=a.recorderEnabled,!b.recorderEnabled&&b.somTextArea&&(k.log("Recorder icon was showing so hiding it since recorderEnabled was disabled."),F(b.somTextArea))),void 0!==a.pageIconEnabled&&(k.log("Updating domain pageIconEnabled: "+a.pageIconEnabled),b.pageIconEnabled=a.pageIconEnabled,b.pageIconEnabled&&null===document.getElementById("sp-page-icon")?Ca():B(!b.pageIconEnabled)),void 0!==
a.previewEnabled&&(k.log("Updating domain previewEnabled: "+a.previewEnabled),b.previewEnabled=a.previewEnabled),void 0!==a.linkExpandEnabled&&(k.log("Updating domain unfurl setting linkExpandEnabled: "+a.linkExpandEnabled),b.linkExpandEnabled=a.linkExpandEnabled));else if(void 0!==a.checkWhich)bc(a.checkWhich),la();else if(void 0!==a.effectsMenu)cc();else if(void 0!==a.closeLightBox)R(),B(!1),ja(!1);else if(void 0!==a.recorderSetupInProgress)b.recordingInProgress=0!==b.lastTooltipRecInfo.recId?"setup":
!0;else if(!a.sessionInfo&&!a.recControlsOpened)if(a.localRecording){console.log("Got localRecording: "+a.localRecording);console.log("Got localRecording.width: "+a.width);console.log("Got localRecording.height: "+a.height);console.log("Got localRecording.hasAudio: "+a.hasAudio);console.log("Got localRecording.durationMS: "+a.durationMS);a.blob="cancel"!==a.localRecording?a.localRecording:void 0;let d=SPRuntime.getSPHost()+"/chromeapp/upload/create";b.browserRecorderDone(a,(e,f,g)=>{let h=(n,p)=>
{SPRuntime.sendMessageToBackground({reportEvent:"AppPublish",props:{destination:"SOM",title:e,success:null!==n,durationMS:a.durationMS,watchUrl:p}});f(n,p)},l="include",m={videoType:"mp4",title:e,resolution:a.width+"x"+a.height,visiblity:3,hasAudio:a.hasAudio,durationMS:a.durationMS,uploadContentType:"video/mp4"};b.channelId&&(l="omit",m.channelId=b.channelId,d+="?session\x3d"+b.channelId);fetch(d,{method:"POST",credentials:l,body:JSON.stringify(m)}).then(n=>{if(!n.ok)throw Error("Got upload create response.ok \x3d\x3d\x3d false (status: "+
n.status+")");return n.json()}).then(n=>{console.log("Got create response: "+JSON.stringify(n));let p=n.uploadUrl,q=n.manageUrl,r=n.playbackUrl;g&&g(q,r);fetch(p,{method:"PUT",body:a.localRecording,headers:{"Content-Type":"video/mp4"}}).then(u=>{console.log("Got upload response.ok: "+u.ok+" (status: "+u.status+")");h(u.ok?q:null,r)}).catch(u=>{console.error("Got upload error: (err: "+u+")");h(null)})}).catch(n=>{console.error("Failed to create upload. (err: "+n+")");h(null)})},()=>{SPRuntime.sendMessageToBackground({reportEvent:"AppPublish",
props:{destination:"Save As",success:!0,durationMS:a.durationMS}})});c=document.getElementsByClassName("som-basicLightbox");1===c.length&&(c[0].style.display="none")}else if(void 0!==a.showBrowserTabButtonHint)ic(a.showBrowserTabButtonHint);else return!1;return!0});b.setRecordingId=function(a){SPRuntime.sendMessageToBackground({setRecordingId:a})};b.debug=function(a){(b.debugging=a)?(k.log("Debug Starting!"),wb("SP-DEBUG","true")):wb("SP-DEBUG","false")};b.show=function(a){b.somTooltip?k.log("SOM tooltip already showing so ignoring call to open."):
(k.log("SOM tooltip showing and pointing to element: "+a.elementId),b.showOnElementId=a.elementId,b.onStartRecording=a.onStartRecording,b.onCancelRecording=a.onCancelRecording,b.onDoneRecording=a.onDoneRecording,tb())};b.advertise=function(a){b.advertiseOptions=a};b.closeAdvertisement=function(){b.advertiseOptions=void 0;T()};b.startBrowserRecorder=function(a,c){k.log("SP Starting browser recorder");hc(a,c)};return b}}(window));